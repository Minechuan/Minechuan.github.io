<html><head><meta http-equiv="Content-Type" content="text/html; charset=utf-8"/><title>Architecture and Pretrain</title><style>
/* cspell:disable-file */
/* webkit printing magic: print all background colors */
html {
	-webkit-print-color-adjust: exact;
}
* {
	box-sizing: border-box;
	-webkit-print-color-adjust: exact;
}

html,
body {
	margin: 0;
	padding: 0;
}
@media only screen {
	body {
		margin: 2em auto;
		max-width: 900px;
		color: rgb(55, 53, 47);
	}
}

body {
	line-height: 1.5;
	white-space: pre-wrap;
}

a,
a.visited {
	color: inherit;
	text-decoration: underline;
}

.pdf-relative-link-path {
	font-size: 80%;
	color: #444;
}

h1,
h2,
h3 {
	letter-spacing: -0.01em;
	line-height: 1.2;
	font-weight: 600;
	margin-bottom: 0;
}

.page-title {
	font-size: 2.5rem;
	font-weight: 700;
	margin-top: 0;
	margin-bottom: 0.75em;
}

h1 {
	font-size: 1.875rem;
	margin-top: 1.875rem;
}

h2 {
	font-size: 1.5rem;
	margin-top: 1.5rem;
}

h3 {
	font-size: 1.25rem;
	margin-top: 1.25rem;
}

.source {
	border: 1px solid #ddd;
	border-radius: 3px;
	padding: 1.5em;
	word-break: break-all;
}

.callout {
	border-radius: 3px;
	padding: 1rem;
}

figure {
	margin: 1.25em 0;
	page-break-inside: avoid;
}

figcaption {
	opacity: 0.5;
	font-size: 85%;
	margin-top: 0.5em;
}

mark {
	background-color: transparent;
}

.indented {
	padding-left: 1.5em;
}

hr {
	background: transparent;
	display: block;
	width: 100%;
	height: 1px;
	visibility: visible;
	border: none;
	border-bottom: 1px solid rgba(55, 53, 47, 0.09);
}

img {
	max-width: 100%;
}

@media only print {
	img {
		max-height: 100vh;
		object-fit: contain;
	}
}

@page {
	margin: 1in;
}

.collection-content {
	font-size: 0.875rem;
}

.column-list {
	display: flex;
	justify-content: space-between;
}

.column {
	padding: 0 1em;
}

.column:first-child {
	padding-left: 0;
}

.column:last-child {
	padding-right: 0;
}

.table_of_contents-item {
	display: block;
	font-size: 0.875rem;
	line-height: 1.3;
	padding: 0.125rem;
}

.table_of_contents-indent-1 {
	margin-left: 1.5rem;
}

.table_of_contents-indent-2 {
	margin-left: 3rem;
}

.table_of_contents-indent-3 {
	margin-left: 4.5rem;
}

.table_of_contents-link {
	text-decoration: none;
	opacity: 0.7;
	border-bottom: 1px solid rgba(55, 53, 47, 0.18);
}

table,
th,
td {
	border: 1px solid rgba(55, 53, 47, 0.09);
	border-collapse: collapse;
}

table {
	border-left: none;
	border-right: none;
}

th,
td {
	font-weight: normal;
	padding: 0.25em 0.5em;
	line-height: 1.5;
	min-height: 1.5em;
	text-align: left;
}

th {
	color: rgba(55, 53, 47, 0.6);
}

ol,
ul {
	margin: 0;
	margin-block-start: 0.6em;
	margin-block-end: 0.6em;
}

li > ol:first-child,
li > ul:first-child {
	margin-block-start: 0.6em;
}

ul > li {
	list-style: disc;
}

ul.to-do-list {
	padding-inline-start: 0;
}

ul.to-do-list > li {
	list-style: none;
}

.to-do-children-checked {
	text-decoration: line-through;
	opacity: 0.375;
}

ul.toggle > li {
	list-style: none;
}

ul {
	padding-inline-start: 1.7em;
}

ul > li {
	padding-left: 0.1em;
}

ol {
	padding-inline-start: 1.6em;
}

ol > li {
	padding-left: 0.2em;
}

.mono ol {
	padding-inline-start: 2em;
}

.mono ol > li {
	text-indent: -0.4em;
}

.toggle {
	padding-inline-start: 0em;
	list-style-type: none;
}

/* Indent toggle children */
.toggle > li > details {
	padding-left: 1.7em;
}

.toggle > li > details > summary {
	margin-left: -1.1em;
}

.selected-value {
	display: inline-block;
	padding: 0 0.5em;
	background: rgba(206, 205, 202, 0.5);
	border-radius: 3px;
	margin-right: 0.5em;
	margin-top: 0.3em;
	margin-bottom: 0.3em;
	white-space: nowrap;
}

.collection-title {
	display: inline-block;
	margin-right: 1em;
}

.page-description {
	margin-bottom: 2em;
}

.simple-table {
	margin-top: 1em;
	font-size: 0.875rem;
	empty-cells: show;
}
.simple-table td {
	height: 29px;
	min-width: 120px;
}

.simple-table th {
	height: 29px;
	min-width: 120px;
}

.simple-table-header-color {
	background: rgb(247, 246, 243);
	color: black;
}
.simple-table-header {
	font-weight: 500;
}

time {
	opacity: 0.5;
}

.icon {
	display: inline-block;
	max-width: 1.2em;
	max-height: 1.2em;
	text-decoration: none;
	vertical-align: text-bottom;
	margin-right: 0.5em;
}

img.icon {
	border-radius: 3px;
}

.user-icon {
	width: 1.5em;
	height: 1.5em;
	border-radius: 100%;
	margin-right: 0.5rem;
}

.user-icon-inner {
	font-size: 0.8em;
}

.text-icon {
	border: 1px solid #000;
	text-align: center;
}

.page-cover-image {
	display: block;
	object-fit: cover;
	width: 100%;
	max-height: 30vh;
}

.page-header-icon {
	font-size: 3rem;
	margin-bottom: 1rem;
}

.page-header-icon-with-cover {
	margin-top: -0.72em;
	margin-left: 0.07em;
}

.page-header-icon img {
	border-radius: 3px;
}

.link-to-page {
	margin: 1em 0;
	padding: 0;
	border: none;
	font-weight: 500;
}

p > .user {
	opacity: 0.5;
}

td > .user,
td > time {
	white-space: nowrap;
}

input[type="checkbox"] {
	transform: scale(1.5);
	margin-right: 0.6em;
	vertical-align: middle;
}

p {
	margin-top: 0.5em;
	margin-bottom: 0.5em;
}

.image {
	border: none;
	margin: 1.5em 0;
	padding: 0;
	border-radius: 0;
	text-align: center;
}

.code,
code {
	background: rgba(135, 131, 120, 0.15);
	border-radius: 3px;
	padding: 0.2em 0.4em;
	border-radius: 3px;
	font-size: 85%;
	tab-size: 2;
}

code {
	color: #eb5757;
}

.code {
	padding: 1.5em 1em;
}

.code-wrap {
	white-space: pre-wrap;
	word-break: break-all;
}

.code > code {
	background: none;
	padding: 0;
	font-size: 100%;
	color: inherit;
}

blockquote {
	font-size: 1.25em;
	margin: 1em 0;
	padding-left: 1em;
	border-left: 3px solid rgb(55, 53, 47);
}

.bookmark {
	text-decoration: none;
	max-height: 8em;
	padding: 0;
	display: flex;
	width: 100%;
	align-items: stretch;
}

.bookmark-title {
	font-size: 0.85em;
	overflow: hidden;
	text-overflow: ellipsis;
	height: 1.75em;
	white-space: nowrap;
}

.bookmark-text {
	display: flex;
	flex-direction: column;
}

.bookmark-info {
	flex: 4 1 180px;
	padding: 12px 14px 14px;
	display: flex;
	flex-direction: column;
	justify-content: space-between;
}

.bookmark-image {
	width: 33%;
	flex: 1 1 180px;
	display: block;
	position: relative;
	object-fit: cover;
	border-radius: 1px;
}

.bookmark-description {
	color: rgba(55, 53, 47, 0.6);
	font-size: 0.75em;
	overflow: hidden;
	max-height: 4.5em;
	word-break: break-word;
}

.bookmark-href {
	font-size: 0.75em;
	margin-top: 0.25em;
}

.sans { font-family: ui-sans-serif, -apple-system, BlinkMacSystemFont, "Segoe UI Variable Display", "Segoe UI", Helvetica, "Apple Color Emoji", Arial, sans-serif, "Segoe UI Emoji", "Segoe UI Symbol"; }
.code { font-family: "SFMono-Regular", Menlo, Consolas, "PT Mono", "Liberation Mono", Courier, monospace; }
.serif { font-family: Lyon-Text, Georgia, ui-serif, serif; }
.mono { font-family: iawriter-mono, Nitti, Menlo, Courier, monospace; }
.pdf .sans { font-family: Inter, ui-sans-serif, -apple-system, BlinkMacSystemFont, "Segoe UI Variable Display", "Segoe UI", Helvetica, "Apple Color Emoji", Arial, sans-serif, "Segoe UI Emoji", "Segoe UI Symbol", 'Twemoji', 'Noto Color Emoji', 'Noto Sans CJK JP'; }
.pdf:lang(zh-CN) .sans { font-family: Inter, ui-sans-serif, -apple-system, BlinkMacSystemFont, "Segoe UI Variable Display", "Segoe UI", Helvetica, "Apple Color Emoji", Arial, sans-serif, "Segoe UI Emoji", "Segoe UI Symbol", 'Twemoji', 'Noto Color Emoji', 'Noto Sans CJK SC'; }
.pdf:lang(zh-TW) .sans { font-family: Inter, ui-sans-serif, -apple-system, BlinkMacSystemFont, "Segoe UI Variable Display", "Segoe UI", Helvetica, "Apple Color Emoji", Arial, sans-serif, "Segoe UI Emoji", "Segoe UI Symbol", 'Twemoji', 'Noto Color Emoji', 'Noto Sans CJK TC'; }
.pdf:lang(ko-KR) .sans { font-family: Inter, ui-sans-serif, -apple-system, BlinkMacSystemFont, "Segoe UI Variable Display", "Segoe UI", Helvetica, "Apple Color Emoji", Arial, sans-serif, "Segoe UI Emoji", "Segoe UI Symbol", 'Twemoji', 'Noto Color Emoji', 'Noto Sans CJK KR'; }
.pdf .code { font-family: Source Code Pro, "SFMono-Regular", Menlo, Consolas, "PT Mono", "Liberation Mono", Courier, monospace, 'Twemoji', 'Noto Color Emoji', 'Noto Sans Mono CJK JP'; }
.pdf:lang(zh-CN) .code { font-family: Source Code Pro, "SFMono-Regular", Menlo, Consolas, "PT Mono", "Liberation Mono", Courier, monospace, 'Twemoji', 'Noto Color Emoji', 'Noto Sans Mono CJK SC'; }
.pdf:lang(zh-TW) .code { font-family: Source Code Pro, "SFMono-Regular", Menlo, Consolas, "PT Mono", "Liberation Mono", Courier, monospace, 'Twemoji', 'Noto Color Emoji', 'Noto Sans Mono CJK TC'; }
.pdf:lang(ko-KR) .code { font-family: Source Code Pro, "SFMono-Regular", Menlo, Consolas, "PT Mono", "Liberation Mono", Courier, monospace, 'Twemoji', 'Noto Color Emoji', 'Noto Sans Mono CJK KR'; }
.pdf .serif { font-family: PT Serif, Lyon-Text, Georgia, ui-serif, serif, 'Twemoji', 'Noto Color Emoji', 'Noto Serif CJK JP'; }
.pdf:lang(zh-CN) .serif { font-family: PT Serif, Lyon-Text, Georgia, ui-serif, serif, 'Twemoji', 'Noto Color Emoji', 'Noto Serif CJK SC'; }
.pdf:lang(zh-TW) .serif { font-family: PT Serif, Lyon-Text, Georgia, ui-serif, serif, 'Twemoji', 'Noto Color Emoji', 'Noto Serif CJK TC'; }
.pdf:lang(ko-KR) .serif { font-family: PT Serif, Lyon-Text, Georgia, ui-serif, serif, 'Twemoji', 'Noto Color Emoji', 'Noto Serif CJK KR'; }
.pdf .mono { font-family: PT Mono, iawriter-mono, Nitti, Menlo, Courier, monospace, 'Twemoji', 'Noto Color Emoji', 'Noto Sans Mono CJK JP'; }
.pdf:lang(zh-CN) .mono { font-family: PT Mono, iawriter-mono, Nitti, Menlo, Courier, monospace, 'Twemoji', 'Noto Color Emoji', 'Noto Sans Mono CJK SC'; }
.pdf:lang(zh-TW) .mono { font-family: PT Mono, iawriter-mono, Nitti, Menlo, Courier, monospace, 'Twemoji', 'Noto Color Emoji', 'Noto Sans Mono CJK TC'; }
.pdf:lang(ko-KR) .mono { font-family: PT Mono, iawriter-mono, Nitti, Menlo, Courier, monospace, 'Twemoji', 'Noto Color Emoji', 'Noto Sans Mono CJK KR'; }
.highlight-default {
	color: rgba(55, 53, 47, 1);
}
.highlight-gray {
	color: rgba(120, 119, 116, 1);
	fill: rgba(120, 119, 116, 1);
}
.highlight-brown {
	color: rgba(159, 107, 83, 1);
	fill: rgba(159, 107, 83, 1);
}
.highlight-orange {
	color: rgba(217, 115, 13, 1);
	fill: rgba(217, 115, 13, 1);
}
.highlight-yellow {
	color: rgba(203, 145, 47, 1);
	fill: rgba(203, 145, 47, 1);
}
.highlight-teal {
	color: rgba(68, 131, 97, 1);
	fill: rgba(68, 131, 97, 1);
}
.highlight-blue {
	color: rgba(51, 126, 169, 1);
	fill: rgba(51, 126, 169, 1);
}
.highlight-purple {
	color: rgba(144, 101, 176, 1);
	fill: rgba(144, 101, 176, 1);
}
.highlight-pink {
	color: rgba(193, 76, 138, 1);
	fill: rgba(193, 76, 138, 1);
}
.highlight-red {
	color: rgba(212, 76, 71, 1);
	fill: rgba(212, 76, 71, 1);
}
.highlight-default_background {
	color: rgba(55, 53, 47, 1);
}
.highlight-gray_background {
	background: rgba(248, 248, 247, 1);
}
.highlight-brown_background {
	background: rgba(244, 238, 238, 1);
}
.highlight-orange_background {
	background: rgba(251, 236, 221, 1);
}
.highlight-yellow_background {
	background: rgba(251, 243, 219, 1);
}
.highlight-teal_background {
	background: rgba(237, 243, 236, 1);
}
.highlight-blue_background {
	background: rgba(231, 243, 248, 1);
}
.highlight-purple_background {
	background: rgba(248, 243, 252, 1);
}
.highlight-pink_background {
	background: rgba(252, 241, 246, 1);
}
.highlight-red_background {
	background: rgba(253, 235, 236, 1);
}
.block-color-default {
	color: inherit;
	fill: inherit;
}
.block-color-gray {
	color: rgba(120, 119, 116, 1);
	fill: rgba(120, 119, 116, 1);
}
.block-color-brown {
	color: rgba(159, 107, 83, 1);
	fill: rgba(159, 107, 83, 1);
}
.block-color-orange {
	color: rgba(217, 115, 13, 1);
	fill: rgba(217, 115, 13, 1);
}
.block-color-yellow {
	color: rgba(203, 145, 47, 1);
	fill: rgba(203, 145, 47, 1);
}
.block-color-teal {
	color: rgba(68, 131, 97, 1);
	fill: rgba(68, 131, 97, 1);
}
.block-color-blue {
	color: rgba(51, 126, 169, 1);
	fill: rgba(51, 126, 169, 1);
}
.block-color-purple {
	color: rgba(144, 101, 176, 1);
	fill: rgba(144, 101, 176, 1);
}
.block-color-pink {
	color: rgba(193, 76, 138, 1);
	fill: rgba(193, 76, 138, 1);
}
.block-color-red {
	color: rgba(212, 76, 71, 1);
	fill: rgba(212, 76, 71, 1);
}
.block-color-default_background {
	color: inherit;
	fill: inherit;
}
.block-color-gray_background {
	background: rgba(248, 248, 247, 1);
}
.block-color-brown_background {
	background: rgba(244, 238, 238, 1);
}
.block-color-orange_background {
	background: rgba(251, 236, 221, 1);
}
.block-color-yellow_background {
	background: rgba(251, 243, 219, 1);
}
.block-color-teal_background {
	background: rgba(237, 243, 236, 1);
}
.block-color-blue_background {
	background: rgba(231, 243, 248, 1);
}
.block-color-purple_background {
	background: rgba(248, 243, 252, 1);
}
.block-color-pink_background {
	background: rgba(252, 241, 246, 1);
}
.block-color-red_background {
	background: rgba(253, 235, 236, 1);
}
.select-value-color-uiBlue { background-color: undefined; }
.select-value-color-pink { background-color: rgba(225, 136, 179, 0.27); }
.select-value-color-purple { background-color: rgba(168, 129, 197, 0.27); }
.select-value-color-green { background-color: rgba(123, 183, 129, 0.27); }
.select-value-color-gray { background-color: rgba(84, 72, 49, 0.15); }
.select-value-color-transparentGray { background-color: undefined; }
.select-value-color-translucentGray { background-color: undefined; }
.select-value-color-orange { background-color: rgba(224, 124, 57, 0.27); }
.select-value-color-brown { background-color: rgba(210, 162, 141, 0.35); }
.select-value-color-red { background-color: rgba(244, 171, 159, 0.4); }
.select-value-color-yellow { background-color: rgba(236, 191, 66, 0.39); }
.select-value-color-blue { background-color: rgba(93, 165, 206, 0.27); }
.select-value-color-pageGlass { background-color: undefined; }
.select-value-color-washGlass { background-color: undefined; }

.checkbox {
	display: inline-flex;
	vertical-align: text-bottom;
	width: 16;
	height: 16;
	background-size: 16px;
	margin-left: 2px;
	margin-right: 5px;
}

.checkbox-on {
	background-image: url("data:image/svg+xml;charset=UTF-8,%3Csvg%20width%3D%2216%22%20height%3D%2216%22%20viewBox%3D%220%200%2016%2016%22%20fill%3D%22none%22%20xmlns%3D%22http%3A%2F%2Fwww.w3.org%2F2000%2Fsvg%22%3E%0A%3Crect%20width%3D%2216%22%20height%3D%2216%22%20fill%3D%22%2358A9D7%22%2F%3E%0A%3Cpath%20d%3D%22M6.71429%2012.2852L14%204.9995L12.7143%203.71436L6.71429%209.71378L3.28571%206.2831L2%207.57092L6.71429%2012.2852Z%22%20fill%3D%22white%22%2F%3E%0A%3C%2Fsvg%3E");
}

.checkbox-off {
	background-image: url("data:image/svg+xml;charset=UTF-8,%3Csvg%20width%3D%2216%22%20height%3D%2216%22%20viewBox%3D%220%200%2016%2016%22%20fill%3D%22none%22%20xmlns%3D%22http%3A%2F%2Fwww.w3.org%2F2000%2Fsvg%22%3E%0A%3Crect%20x%3D%220.75%22%20y%3D%220.75%22%20width%3D%2214.5%22%20height%3D%2214.5%22%20fill%3D%22white%22%20stroke%3D%22%2336352F%22%20stroke-width%3D%221.5%22%2F%3E%0A%3C%2Fsvg%3E");
}
	
</style></head><body><article id="1a58841f-85ab-8043-801a-e5e383f5813e" class="page sans"><header><div class="page-header-icon undefined"><span class="icon">ğŸ¦¾</span></div><h1 class="page-title">Architecture and Pretrain</h1><p class="page-description"></p></header><div class="page-body"><p id="1ca8841f-85ab-804f-8b62-cfee0ff1ecf0" class=""><strong>Topics Covered: Strucure &amp; Pretrain</strong></p><h2 id="1ca8841f-85ab-805a-9e3c-ffc5af0e4cbc" class="">Introduction</h2><p id="1ca8841f-85ab-80fe-b82a-c478e4e7ab6c" class="">å…³é”®ï¼šå¦‚ä½•ä½¿ç”¨æ›´é«˜æ•ˆçš„ç®—åŠ›æ¥è®­ç»ƒæ›´å¥½çš„æ¨¡å‹ã€‚</p><h2 id="1ca8841f-85ab-8072-95d1-d0c19478d9b9" class="">Scaling Law</h2><p id="1ca8841f-85ab-808c-bed2-def70f84c2f6" class="">Bitter lessonï¼šä¸éœ€è¦è®¾ç½®å¤ªå¤šçš„åç½®ï¼Œå¦åˆ™æ€§èƒ½çš„æå‡ä¼šç›¸å¯¹è¾ƒæ…¢ã€‚ä¹Ÿå°±æ˜¯ç ”ç©¶è€…ä¸ç”¨è´¹å°½å¿ƒæ€å»ä½¿ç”¨å„ç§ tricks æ¥å¯¹å¤§æ¨¡å‹è¿›è¡Œç»†å¾®çš„æå‡ï¼Œå› ä¸ºéšç€ç®—åŠ›çš„æå‡ï¼Œå‚æ•°é‡å’Œè®­ç»ƒæ•°æ®çš„å¢å¤§æ¨¡å‹çš„æ•ˆæœä¼šå¾—åˆ°å¾ˆå¤§çš„æå‡ã€‚</p><p id="1ca8841f-85ab-80d1-ac60-ed69d52292f1" class="">The Scaling Lawï¼šå¤§æ¨¡å‹çš„è§„æ¨¡å¢åŠ ï¼Œæ€§èƒ½æœç€ç›´çº¿å‘å±•ï¼ˆè®ºæ–‡ï¼š<span style="border-bottom:0.05em solid">Scaling Law for Neural Language Modelï¼‰</span></p><ol type="1" id="1ca8841f-85ab-8095-8a2f-dc23826bcf1c" class="numbered-list" start="1"><li>å‚æ•°<ol type="a" id="1ca8841f-85ab-803b-b48b-f6bcc25d61be" class="numbered-list" start="1"><li>å‚æ•°è§„æ¨¡N</li></ol><ol type="a" id="1ca8841f-85ab-80cd-93c3-ed9ff96b6632" class="numbered-list" start="2"><li>æ•°æ®è§„æ¨¡D</li></ol><ol type="a" id="1ca8841f-85ab-80a5-9669-cd810e2c698e" class="numbered-list" start="3"><li>è®¡ç®—è§„æ¨¡C</li></ol></li></ol><ol type="1" id="1ca8841f-85ab-80bf-b788-c1968abfbf0e" class="numbered-list" start="2"><li>ä¸æ€§èƒ½å‘ˆç°å¹‚ç‡å…³ç³»ï¼Œå³åŒæ—¶å–å¯¹æ•°åå¯ä»¥æ‹Ÿåˆä¸€æ¡ç›´çº¿ã€‚</li></ol><ol type="1" id="1ca8841f-85ab-808e-9837-cfad27041604" class="numbered-list" start="3"><li>ä¸‰ä¸ªå‚æ•°ä¹‹é—´çš„è”ç³»ï¼š<style>@import url('https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.16.9/katex.min.css')</style><span data-token-index="0" contenteditable="false" class="notion-text-equation-token" style="user-select:all;-webkit-user-select:all;-moz-user-select:all"><span></span><span><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>C</mi><mo>âˆ¼</mo><mn>6</mn><mi>N</mi><mi>D</mi></mrow><annotation encoding="application/x-tex">C\sim 6ND</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord mathnormal" style="margin-right:0.07153em;">C</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">âˆ¼</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord">6</span><span class="mord mathnormal" style="margin-right:0.10903em;">N</span><span class="mord mathnormal" style="margin-right:0.02778em;">D</span></span></span></span></span><span>ï»¿</span></span>ï¼ˆå¯ä»¥ä½¿ç”¨è¿™ä¸€å…¬å¼è®¡ç®—åœ¨ç‰¹å®šæ¡ä»¶ä¸‹æ¨¡å‹åº”è¯¥è®¾ç½®çš„è®­ç»ƒå‚æ•°ï¼‰ã€‚</li></ol><p id="1ca8841f-85ab-8012-acd7-dc1b5293398a" class="">é€šè¿‡å¯¹å„é¡¹æ¬¡æ•°çš„æ¯”è¾ƒï¼Œå‘ç°åœ¨ç®—åŠ›ä¸€å®šæ—¶ï¼Œå¢å¤§æ¨¡å‹è§„æ¨¡å¯¹æ€§èƒ½çš„è´¡çŒ®æ›´å¤§ã€‚</p><h3 id="1ca8841f-85ab-8040-92a7-ccea0d492bf5" class="">Chinchilla Law</h3><p id="1ca8841f-85ab-80f0-8a9f-ed4533406051" class="">åº”è¯¥åŒæ¯”ä¾‹æ‰©å¢æ•°æ®ï¼ˆdata setï¼‰å’Œå‚æ•°ï¼Œäºæ˜¯å¼€å§‹ä½¿ç”¨äº’è”ç½‘æ•°æ®ã€‚</p><p id="1ca8841f-85ab-80a8-a0c4-fdffb1b6d5fe" class="">æ±‚è§£ Scaling Law çš„æ–¹æ³•ï¼šåˆ†ç¦»å˜é‡æ³•ï¼Œå¤šè®­ç»ƒå‡ ä¸ªæ¨¡å‹ï¼Œæ‹Ÿåˆå¹‚ç‡ã€‚</p><p id="1ca8841f-85ab-808c-bdbb-e307a341b0f5" class=""><strong>å‹ç¼©æ¯”</strong>ï¼šä¸€ä¸ªparameter åº”è¯¥å‹ç¼©å¤šå°‘ tokenã€‚å®é™…é—®é¢˜ï¼štoken å·²ç»è¢«ç”¨å°½ï¼Œä½†æ˜¯ç”¨ LLM ç”Ÿæˆæ•°æ®å¯èƒ½ä¼šé€ æˆæ±¡æŸ“ï¼Œæ¨¡å‹è¶Šæ¥è¶Šâ€œç¬¨â€ã€‚éœ€è¦é«˜è´¨é‡çš„åˆæˆæ•°æ®ã€‚è§£å†³ï¼šä½¿ç”¨æ–°çš„æ¶æ„æˆ–æŠ€æœ¯æ¥ä¼˜åŒ–ï¼Œä½¿ç”¨æ–°çš„èŒƒå¼æ‰¾åˆ°ä¼˜åŒ–ç©ºé—´ï¼Œå¦‚K-V Cacheã€å¼ºåŒ–å­¦ä¹ ã€‚</p><p id="1ca8841f-85ab-8080-b171-c6609f445d9c" class="">æ€»ç»“ï¼š</p><ol type="1" id="1ca8841f-85ab-80ef-bfe8-fdad2d8da218" class="numbered-list" start="1"><li>åˆ©ç”¨ Scaling lawï¼Œæ¨¡å‹çš„è®­ç»ƒå…·æœ‰å¯é¢„æµ‹æ€§</li></ol><ol type="1" id="1ca8841f-85ab-80ce-8bec-e1e9794ebd84" class="numbered-list" start="2"><li>éšç€è®­ç»ƒè§„æ¨¡çš„å¢å¤§ï¼Œè¾¹é™…æ•ˆç›Šå¯èƒ½é€’å‡</li></ol><figure id="1ca8841f-85ab-803a-b2e2-e18fdc1d1ef6" class="image"><a href="image.png"><img style="width:709.9793701171875px" src="image.png"/></a></figure><h3 id="1ca8841f-85ab-8086-8605-ff953be20ccc" class="">Emergencyï¼ˆæ¶Œç°ï¼‰</h3><p id="1ca8841f-85ab-809b-8958-e4196188912c" class="">æ˜¯å¦ä¼šäº§ç”Ÿç›¸å˜å¼çš„æ¶Œç°ã€‚ä¸´ç•Œç°è±¡æ˜¯å¦æ˜¯ mearsurement çš„é—®é¢˜ï¼Ÿåœ¨å®éªŒä¸­éœ€è¦å…·ä½“åˆ»ç”»ï¼Œæœ‰ç ”ç©¶è€…æŒ‡å‡ºï¼šä¹‹å‰æ‰€è°“çš„ Scaling Law å¯èƒ½ä¹‹å‰é€‰æ‹©äº†é”™è¯¯çš„ y è½´ï¼Œæ‰€ä»¥æ¶Œç°åªæ˜¯è¡¨é¢ç°è±¡ã€‚</p><p id="1ca8841f-85ab-80f4-b674-f92009e95f60" class="">é€šå¸¸å½“ Loss å°äº 2.25 æ—¶å¼€å§‹æ¶Œç°ã€‚ä½†æ˜¯é¢„è®­ç»ƒé˜¶æ®µçš„ Scaling law æ•ˆæœæœ‰é™ï¼Œè‡ªå›å½’å­¦ä¹ ä¸­æ²¡æœ‰åŠæ³•è‡ªä¸»ä¿®æ­£ã€‚å¦å¤–å¼ºåŒ–å­¦ä¹ ä¸­ä¹Ÿæœ‰ Scaling lawï¼špost-training Scaling Law</p><h3 id="1ca8841f-85ab-8033-bb39-fdefdf2983cb" class="">Inferenceï¼ˆæ¨ç†ï¼‰</h3><p id="1ca8841f-85ab-8093-ac10-e7cd9b300c64" class="">äººæœ‰ä¸¤å¥—æ¨ç†ç³»ç»Ÿï¼šfast and slow</p><p id="1ca8841f-85ab-8072-8a34-ead6bbf7080d" class="">System 1ï¼šèŠ‚çº¦è®¤çŸ¥èµ„æºï¼Œä½†æ˜¯ä¼šå—åˆ°åå·®å’Œæƒ…ç»ªçš„å½±å“</p><p id="1ca8841f-85ab-8080-8493-e8ace9376a26" class="">System 2ï¼šæ·±åº¦æ€è€ƒï¼Œé€Ÿåº¦æ…¢</p><p id="1ca8841f-85ab-8061-9653-feca56dfa9b4" class="">LLM å¯¹äºæ¨ç†é—®é¢˜æœ‰ä¸åŒçš„èŒƒå¼ï¼šCOTï¼šChain-of-thought</p><p id="1ca8841f-85ab-80ec-b65b-f54225e86432" class="">COTï¼šæ€è€ƒé—®é¢˜åº”è¯¥å¦‚ä½•è§£ç­”ï¼Œç‡å…ˆåˆ†æé—®é¢˜ã€‚</p><p id="1ca8841f-85ab-800a-a4f7-d1e00516de2e" class="">åœ¨ prompt ä¹‹ååŠ ä¸Šâ€œlet&#x27;s think atep by stepâ€ï¼Œæ•ˆæœæœ‰æ˜æ˜¾çš„æå‡ã€‚ï¼ˆå¤§æ¨¡å‹çš„å‘å±•è¿‡ç¨‹ä¸­OpenAI å’Œ deepmind ä¸¤è€…ç›¸äº’è¿­ä»£ï¼‰ä¸‹ä¸€ä»£LLMåº”è¯¥æœ‰ reasoning å’Œ search ç»“åˆã€‚ä½†æ˜¯å½“æ¨ç†æå‡æ—¶ï¼Œæ–‡å­—çš„å¤„ç†èƒ½åŠ›ä¼šä¸‹é™ã€‚ç›®å‰æ­£åœ¨æ€è€ƒï¼šèƒ½å¦æŠŠä¸¤ä¸ªæ¨¡å‹ç»“åˆèµ·æ¥ã€‚</p><p id="1ca8841f-85ab-8033-8f02-f4d8bcd480cc" class="">æœ€åˆï¼Œåè®­ç»ƒé˜¶æ®µé€šå¸¸åªä½¿ç”¨é¢„è®­ç»ƒé˜¶æ®µçš„ 1% çš„ç®—åŠ›å’Œè¯­æ–™ã€‚ç°åœ¨ç”±äºé¢„è®­ç»ƒé˜¶æ®µåŸºæœ¬ä½¿ç”¨äº†å…¨éƒ¨çš„è¯­æ–™ï¼Œé¢„è®­ç»ƒé˜¶æ®µçš„æå‡ç©ºé—´æ¯”è¾ƒå°ã€‚ç ”ç©¶è€…åœ¨åè®­ç»ƒé˜¶æ®µæŠ•å…¥ç®—åŠ›çš„æ¯”ä¾‹æ˜æ˜¾å¢å¤§ã€‚æˆ‘ä»¬å‘ç°ï¼šåè®­ç»ƒé˜¶æ®µä¹Ÿæœ‰ Scaling law</p><h2 id="1b38841f-85ab-800a-a604-ea06896d534a" class="">Structure</h2><h3 id="1a58841f-85ab-8060-abb9-c0fb383efdcd" class=""><strong>GPT 3â€”â€”å‚æ•°é‡è®¡ç®—å®ä¾‹</strong></h3><p id="1ca8841f-85ab-80b7-afc4-c38dcec31aea" class="">è®¡ç®— GPT3 çš„å‚æ•°é‡â€”â€”å‚è€ƒ 3Blue1Brown çš„è§†é¢‘ã€‚</p><p id="1a58841f-85ab-80a2-bfe0-d4a114986892" class="">æ¨¡å‹æ¶æ„ï¼šMLP+Attention</p><figure id="1a58841f-85ab-80bf-a696-d86a108bae12" class="image"><a href="image%201.png"><img style="width:288px" src="image%201.png"/></a></figure><p id="1b38841f-85ab-80ad-a044-efa688879ed7" class="">
</p><figure id="1a58841f-85ab-803d-863b-d3aabf1d10c4" class="image"><a href="image%202.png"><img style="width:515.5647583007812px" src="image%202.png"/></a></figure><p id="1a58841f-85ab-80d2-8c4d-f661a6269f25" class="">å‚æ•°é‡çš„è®¡ç®—ï¼š</p><p id="1cf8841f-85ab-8078-a3d6-f7ad30f1bef8" class="">1ï¸âƒ£Attentiom</p><p id="1cf8841f-85ab-8034-ac8b-d370b8b5569a" class="">ä¸åŒè¯ä¸­é—´æœ‰è·ç¦»å…³ç³»ï¼ŒValue å’Œ Output å®é™…ä¸Šæ˜¯ä¸€ä¸ª å¤§çš„ Value matrixï¼Œå¤šä¸ªè¯æœ‰ä¿®é¥°å…³ç³» QKVã€‚å¯¹äº Multi-head attentionï¼šå¤´æ•°*å¤´ç»´åº¦=è¯å‘é‡ç»´åº¦ï¼Œæ‰€ä»¥æ¯ä¸€ä¸ªå¤´å®é™…ä¸Šæ¯”å•å¤´çš„è¾“å‡ºå˜çŸ­ã€‚</p><p id="1cf8841f-85ab-8058-9fd1-fb001e9571fd" class="">ç›´è§‚ç†è§£ Q åœ¨è¯è¡¨ç¤ºç©ºé—´ä¸­è¯¢é—®ä¸è‡ªå·±çš„ç›¸å…³æ€§ï¼ˆæé—®é¢˜ï¼šquery blockï¼‰ï¼Œæ„æˆ query matrix: é—®é—®é¢˜çš„æ–¹å¼ç”±è®­ç»ƒå¾—åˆ°ï¼ŒK blockï¼šçœ‹åšä¸€ç§å›ç­”ã€‚</p><figure id="1a58841f-85ab-8029-9000-e6651f84191d" class="image"><a href="image%203.png"><img style="width:459.5902099609375px" src="image%203.png"/></a></figure><p id="1a58841f-85ab-80d0-9511-f52553a4ceba" class="">æˆ‘ä»¬é€šè¿‡è®¡ç®— <style>@import url('https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.16.9/katex.min.css')</style><span data-token-index="0" contenteditable="false" class="notion-text-equation-token" style="user-select:all;-webkit-user-select:all;-moz-user-select:all"><span></span><span><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>Q</mi><mi>i</mi></msub></mrow><annotation encoding="application/x-tex">Q_i</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8778em;vertical-align:-0.1944em;"></span><span class="mord"><span class="mord mathnormal">Q</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3117em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">i</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span></span><span>ï»¿</span></span> å’Œ <style>@import url('https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.16.9/katex.min.css')</style><span data-token-index="0" contenteditable="false" class="notion-text-equation-token" style="user-select:all;-webkit-user-select:all;-moz-user-select:all"><span></span><span><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>K</mi><mi>j</mi></msub></mrow><annotation encoding="application/x-tex">K_j</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.9694em;vertical-align:-0.2861em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.07153em;">K</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3117em;"><span style="top:-2.55em;margin-left:-0.0715em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.05724em;">j</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.2861em;"><span></span></span></span></span></span></span></span></span></span></span><span>ï»¿</span></span> ä¹‹é—´çš„è·ç¦»ï¼Œå¾—åˆ°å¯¹äºæ¯ä¸€åˆ—æ¥è¯´ï¼Œæ¯ä¸€è¡Œåˆ°åº•æœ‰å¤šç›¸å…³ã€‚ï¼ˆQï¼ŒK è§£å†³å…³ç³»çš„é—®é¢˜ï¼‰</p><p id="1a58841f-85ab-800b-8778-ed77accf2a07" class="">å¯¹è¯­è¨€æ¨¡å‹ï¼Œé€šå¸¸ä¼šåšmaskï¼Œå³ä¹‹å‰çš„å•è¯ä¸èƒ½çœ‹åˆ°ä¹‹åçš„å•è¯ï¼Œæ‰€ä»¥æ˜¯ä¸€ä¸ªä¸Šä¸‰è§’çŸ©é˜µã€‚ä¹‹åè§£å†³ä¿®é¥°æ—¶æ¨¡é•¿çš„é—®é¢˜</p><figure id="1a58841f-85ab-80d6-a2b1-cdd33be198c6" class="image"><a href="image%204.png"><img style="width:720px" src="image%204.png"/></a></figure><p id="1cf8841f-85ab-806d-a2f0-c18265e2fb8d" class="">é‡‡ç”¨ä½ç§©çš„ çŸ©é˜µï¼Œå°†å¤§çš„ Value çŸ©é˜µæ‹†åˆ†æˆä¸¤ä¸ªçŸ©é˜µï¼Œå‡å°‘è®­ç»ƒæ—¶çš„å‚æ•°é‡ã€‚</p><figure id="1a58841f-85ab-8086-9b1e-dbf461c0e4a0" class="image"><a href="image%205.png"><img style="width:768px" src="image%205.png"/></a></figure><p id="1a58841f-85ab-8051-91c6-d6c8869f2173" class="">Attention ç”¨æ‰çº¦ 1/3 çš„å‚æ•°ï¼Œä¹‹åå…¨è¿æ¥å±‚æ¶ˆè€—å¤§é‡çš„å‚æ•°ã€‚(å¹¶ä¸æ˜¯ attention is all you need!)</p><p id="1a58841f-85ab-80ad-a7dd-f3d051ed1c73" class="">2ï¸âƒ£MLP çš„ä½œç”¨ï¼ŒæŠŠå•è¯ä½œä¸ºâ€œå¸¸è¯†â€œå‚¨å­˜åœ¨ç½‘ç»œå‚æ•°ä¸­ï¼Œå¯ä»¥å°†å‚æ•°çš„ä½œç”¨ç†è§£ä¸ºâ€œè®°å¿†â€ã€‚</p><p id="1a58841f-85ab-80b7-9c22-c5829bf71eaf" class="">The MLP layer stores facts: it tells how each input aligns with specific directionã€‚</p><figure id="1a58841f-85ab-8092-97c4-ec1ede07ac45" class="image"><a href="image%206.png"><img style="width:515.5647583007812px" src="image%206.png"/></a></figure><p id="1a58841f-85ab-804b-b89f-e81d26a95ec9" class="">ç›´è§‚è€ƒè™‘ï¼šR æ¯ä¸€è¡Œ encode ä¸åŒçš„å«ä¹‰ã€‚(ç›´è§‚ï¼šé€šè¿‡ä¸€ç³»åˆ—è¯¢é—®ç¡®å®š<mark class="highlight-orange_background">æ˜¯å“ªä¸€ä¸ª Jordan</mark>)ã€‚CçŸ©é˜µè®°å¿†æ›´å…·ä½“çš„ä¿¡æ¯ï¼ˆç›´è§‚ï¼šæ ¹æ®æ¿€æ´»åçš„å‘é‡ç¡®å®šåº”è¯¥æ·»åŠ ä»€ä¹ˆå±æ€§ï¼Œå¦‚â€œå›½ç±åœ¨å“ªé‡Œâ€ï¼‰</p><figure id="1a58841f-85ab-80fe-9738-fac92ff8d661" class="image"><a href="image%207.png"><img style="width:515.5647583007812px" src="image%207.png"/></a></figure><h3 id="1a58841f-85ab-80b6-b94c-cd7d8ae1ea2b" class="">The super-position effect</h3><p id="1cf8841f-85ab-8059-8fe5-e66116117ec9" class="">è¯å‘é‡ç©ºé—´è¶Šé«˜ï¼Œè¡¨å¾çš„ä¿¡æ¯è¶Šå¤šï¼Œå‘ˆç°æŒ‡æ•°å¢é•¿ã€‚</p><figure id="1a58841f-85ab-80c3-bab4-d089e97ea32e" class="image"><a href="image%208.png"><img style="width:515.5647583007812px" src="image%208.png"/></a></figure><h2 id="1ac8841f-85ab-80a9-b7d9-fffb68181071" class="">Cross attention</h2><p id="1ac8841f-85ab-807a-994d-d2eeecd104ba" class="">å¯¹åº” encoder å’Œ decoder ï¼Œä¹Ÿå¯ä»¥ cross å¤šæ¨¡æ€ã€‚å¯¹æ¯”å‡ ç§ attention ç»“æ„ï¼šï¼ˆç°åœ¨çš„å¤šæ•°æ¨¡å‹ GPT ä½¿ç”¨ Decoder-onlyï¼‰</p><figure id="1ac8841f-85ab-80e3-a173-e92b0a5e6df4" class="image"><a href="image%209.png"><img style="width:624px" src="image%209.png"/></a></figure><h2 id="1ac8841f-85ab-80af-9ed4-fd8825c3db85" class="">Bert è®­ç»ƒ</h2><p id="1ac8841f-85ab-80b3-b73a-f2993fd09121" class=""><strong>WordPiece ç®—æ³•</strong>ï¼šå¯¹ä¸åœ¨è¯å…¸ä¸­çš„è¯ä½œåˆ†å‰²ï¼Œåœ¨è¯æ±‡è¡¨ä¸­æ‰¾åˆ°æœ€é•¿åŒ¹é…å­ä¸²ã€‚</p><p id="1ca8841f-85ab-8009-9968-e79558baf491" class="">BERT ï¼ˆ<strong>Bidirectional Encoder Representations from Transformersï¼‰</strong>çš„è®­ç»ƒä»»åŠ¡è®¾è®¡ï¼šæ˜¯ encoder-decoder çš„æ¶æ„</p><ol type="1" id="1b38841f-85ab-80d2-bdb7-ef53d4adcaf1" class="numbered-list" start="1"><li>éšæœºMask 15% çš„ tokenï¼Œç”¨ Mask ä»£æ›¿ã€‚</li></ol><ol type="1" id="1b38841f-85ab-80cd-9dbc-edfff44acbfe" class="numbered-list" start="2"><li>ç”¨äºŒåˆ†ç±»è®¾è®¡ä¸€ä¸ªåˆ¤æ–­ä¸€ä¸ªå¥å­æ˜¯å¦æ˜¯å¦ä¸€ä¸ªå¥å­çš„ä¸‹ä¸€å¥è¯çš„ä»»åŠ¡</li></ol><ol type="1" id="1b38841f-85ab-8051-849a-dd85c0dbf140" class="numbered-list" start="3"><li>ä¸‹æ¸¸ä»»åŠ¡ä½¿ç”¨æ—¶ç”¨é¢å¤–çš„ softmax å±‚ï¼Œéœ€è¦å¤šè·‘ä¸€äº› epochsã€‚</li></ol><ol type="1" id="1b38841f-85ab-80ae-a54a-fa7ef0ccf9b3" class="numbered-list" start="4"><li>ç¼ºç‚¹ï¼šå¯ä»¥åšåˆ†ç±»ä»»åŠ¡ï¼Œä½†æ˜¯ä¸èƒ½åšæœºå™¨ç¿»è¯‘</li></ol><h3 id="1ac8841f-85ab-8071-b2b0-f7b069828b15" class="">GPT 2</h3><p id="1ac8841f-85ab-8045-8778-c5d1495c06c7" class="">no SFT, zero-shot, é€šè¿‡å¢å¤§å‚æ•°é‡æ¥æé«˜æ•ˆæœã€‚</p><h3 id="1ac8841f-85ab-8063-80df-e33bfa1b60ee" class="">GPT 3: In-context learning </h3><figure id="1cf8841f-85ab-80b7-be45-d35e6fa21c37" class="image"><a href="image%2010.png"><img style="width:709.98681640625px" src="image%2010.png"/></a></figure><p id="1cf8841f-85ab-802d-afa1-f2e4aa1a76f2" class="">In Context Learningï¼ˆICLï¼‰çš„å…³é”®æ€æƒ³æ˜¯ä»ç±»æ¯”ä¸­å­¦ä¹ ã€‚ä¸Šå›¾ç»™å‡ºäº†ä¸€ä¸ªæè¿°è¯­è¨€æ¨¡å‹å¦‚ä½•ä½¿ç”¨ ICL è¿›è¡Œå†³ç­–çš„ä¾‹å­ã€‚é¦–å…ˆï¼ŒICL éœ€è¦ä¸€äº›ç¤ºä¾‹æ¥å½¢æˆä¸€ä¸ªæ¼”ç¤ºä¸Šä¸‹æ–‡ã€‚è¿™äº›ç¤ºä¾‹é€šå¸¸æ˜¯ç”¨è‡ªç„¶è¯­è¨€æ¨¡æ¿ç¼–å†™çš„ã€‚ç„¶å ICL å°†æŸ¥è¯¢çš„é—®é¢˜ï¼ˆå³ä½ éœ€è¦é¢„æµ‹æ ‡ç­¾çš„ inputï¼‰å’Œä¸€ä¸ªä¸Šä¸‹æ–‡æ¼”ç¤ºï¼ˆä¸€äº›ç›¸å…³çš„ casesï¼‰è¿æ¥åœ¨ä¸€èµ·ï¼Œå½¢æˆå¸¦æœ‰æç¤ºçš„è¾“å…¥ï¼Œå¹¶å°†å…¶è¾“å…¥åˆ°è¯­è¨€æ¨¡å‹ä¸­è¿›è¡Œé¢„æµ‹ã€‚</p><p id="1b38841f-85ab-8074-b163-d3cd4c1f9bcc" class="">intuitionï¼š</p><ol type="1" id="1b38841f-85ab-8015-a57d-d3b6a7c7b02f" class="numbered-list" start="1"><li>å¾®è°ƒæ•ˆæœå¥½ï¼Œä¸ä»£è¡¨é€šç”¨æ€§å¥½ï¼Œæ‰€ä»¥é¢„è®­ç»ƒæ¨¡å‹çš„æƒé‡ä¸åº”è¯¥åœ¨ä»»åŠ¡ä¸Šç»å¸¸è¢«è°ƒæ•´ã€‚</li></ol><ol type="1" id="1b38841f-85ab-8092-a3f0-d911aeb8f4c7" class="numbered-list" start="2"><li>Few-shotï¼Œzero-shot å­¦ä¹ åº”è¯¥è¢«å…³æ³¨</li></ol><ol type="1" id="1b38841f-85ab-8091-a11d-d3f9f60d5a0d" class="numbered-list" start="3"><li>é€šè¿‡ in-context learning  åš meta Learning å®Œæˆå¤šä»»åŠ¡ã€‚</li></ol><h2 id="1ac8841f-85ab-80ee-b9d9-c6b961f2522f" class="">Deepseek-V3</h2><h3 id="1ac8841f-85ab-8074-aeed-f6977214f236" class=""> MoE(Mixture of expertï¼‰</h3><ol type="1" id="1ac8841f-85ab-80fc-bc70-d9e4fc1408f9" class="numbered-list" start="1"><li>æœ‰ä¸€äº›ä¸“å®¶â€œå¸¸ç”¨çš„â€ï¼Œå³æ‰€æœ‰çš„ token éƒ½ç»è¿‡çš„ MLPï¼Œé€šè¿‡å¢åŠ ä¸“å®¶çš„æ•°é‡ï¼Œå‡å°‘å‚æ•°é‡ï¼Œæœ€ç»ˆåˆ©ç”¨äº†è¾ƒä½çš„è®¡ç®—é‡ã€‚</li></ol><figure id="1ac8841f-85ab-8003-9189-cc12d435e5c5" class="image"><a href="image%2011.png"><img style="width:576px" src="image%2011.png"/></a></figure><ol type="1" id="1ac8841f-85ab-8007-b76c-d8c5763bab2e" class="numbered-list" start="2"><li>å¼•å…¥äº†åŠ¨æ€åç½® bï¼Œä½†æ˜¯ä¸å½±å“æ¢¯åº¦ï¼šä¸å…¶è®© token é€‰æ‹© expertï¼Œä¸å¦‚è®© expert é€‰æ‹© tokenã€‚</li></ol><figure id="1b38841f-85ab-80d0-906c-da9d315a5abd" class="image"><a href="image%2012.png"><img style="width:505.86328125px" src="image%2012.png"/></a></figure><ol type="1" id="1b38841f-85ab-8033-8fd6-d6754073cd69" class="numbered-list" start="3"><li>åœ¨ gating ä½œäº†è´Ÿè½½å‡è¡¡ï¼Œä½¿ä¸åŒçš„ expert å¤„ç†çš„ä»»åŠ¡æ•°é‡å·®åˆ«ä¸å¤ªå¤§ã€‚</li></ol><h3 id="1ac8841f-85ab-8038-a51a-d550efc7a146" class="">MLA(Multi-head Latent Attention)</h3><p id="1cf8841f-85ab-8047-a632-c67deeccf3a5" class="">è®¡ç®— attention æ—¶, K å’Œ Value çš„ç»´åº¦å¾ˆé«˜ã€‚They use a <code>Compression</code> to shorten the dimension of Key and Value matrix. Like a encoder in the attention. </p><p id="1cf8841f-85ab-80df-b50d-dbbd7866a415" class=""><em><strong>æ ¸å¿ƒæœºåˆ¶ï¼š</strong></em></p><p id="1cf8841f-85ab-808a-bdc5-ff14f7697e20" class="">1ï¸âƒ£ç»´åº¦å‹ç¼©:ç­–ç•¥-Key/Value é™ç»´ï¼šé€šè¿‡å¯å­¦ä¹ çš„å‹ç¼©çŸ©é˜µ <style>@import url('https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.16.9/katex.min.css')</style><span data-token-index="0" contenteditable="false" class="notion-text-equation-token" style="user-select:all;-webkit-user-select:all;-moz-user-select:all"><span></span><span><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msup><mi>W</mi><mrow><mi>D</mi><mi>K</mi><mi>V</mi></mrow></msup><mo>âˆˆ</mo><msup><mi mathvariant="double-struck">R</mi><mrow><msub><mi>d</mi><mrow><mi>l</mi><mi>a</mi><mi>t</mi><mi>e</mi><mi>n</mi><mi>t</mi></mrow></msub><mo>Ã—</mo><msub><mi>d</mi><mrow><mi>m</mi><mi>o</mi><mi>d</mi><mi>e</mi><mi>l</mi></mrow></msub></mrow></msup></mrow><annotation encoding="application/x-tex">W^{DKV} \in \mathbb{R}^{d_{latent} \times d_{model}}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8804em;vertical-align:-0.0391em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.13889em;">W</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8413em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.07153em;">DK</span><span class="mord mathnormal mtight" style="margin-right:0.22222em;">V</span></span></span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">âˆˆ</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.8491em;"></span><span class="mord"><span class="mord mathbb">R</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8491em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight"><span class="mord mathnormal mtight">d</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3448em;"><span style="top:-2.3488em;margin-left:0em;margin-right:0.0714em;"><span class="pstrut" style="height:2.5em;"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.01968em;">l</span><span class="mord mathnormal mtight">a</span><span class="mord mathnormal mtight">t</span><span class="mord mathnormal mtight">e</span><span class="mord mathnormal mtight">n</span><span class="mord mathnormal mtight">t</span></span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.1512em;"><span></span></span></span></span></span></span><span class="mbin mtight">Ã—</span><span class="mord mtight"><span class="mord mathnormal mtight">d</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3448em;"><span style="top:-2.3488em;margin-left:0em;margin-right:0.0714em;"><span class="pstrut" style="height:2.5em;"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">m</span><span class="mord mathnormal mtight">o</span><span class="mord mathnormal mtight">d</span><span class="mord mathnormal mtight">e</span><span class="mord mathnormal mtight" style="margin-right:0.01968em;">l</span></span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.1512em;"><span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span><span>ï»¿</span></span> å°†åŸå§‹é«˜ç»´éšçŠ¶æ€ <style>@import url('https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.16.9/katex.min.css')</style><span data-token-index="0" contenteditable="false" class="notion-text-equation-token" style="user-select:all;-webkit-user-select:all;-moz-user-select:all"><span></span><span><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>h</mi><mi>t</mi></msub><mo>âˆˆ</mo><msup><mi mathvariant="double-struck">R</mi><msub><mi>d</mi><mrow><mi>m</mi><mi>o</mi><mi>d</mi><mi>e</mi><mi>l</mi></mrow></msub></msup></mrow><annotation encoding="application/x-tex">h_t \in \mathbb{R}^{d_{model}}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8444em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal">h</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.2806em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">t</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">âˆˆ</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.8491em;"></span><span class="mord"><span class="mord mathbb">R</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8491em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight"><span class="mord mathnormal mtight">d</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3448em;"><span style="top:-2.3488em;margin-left:0em;margin-right:0.0714em;"><span class="pstrut" style="height:2.5em;"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">m</span><span class="mord mathnormal mtight">o</span><span class="mord mathnormal mtight">d</span><span class="mord mathnormal mtight">e</span><span class="mord mathnormal mtight" style="margin-right:0.01968em;">l</span></span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.1512em;"><span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span><span>ï»¿</span></span> æŠ•å½±åˆ°ä½ç»´ç©ºé—´ï¼š<style>@import url('https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.16.9/katex.min.css')</style><span data-token-index="0" contenteditable="false" class="notion-text-equation-token" style="user-select:all;-webkit-user-select:all;-moz-user-select:all"><span></span><span><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msubsup><mi>c</mi><mi>t</mi><mrow><mi>K</mi><mi>V</mi></mrow></msubsup><mo>=</mo><msup><mi>W</mi><mrow><mi>D</mi><mi>K</mi><mi>V</mi></mrow></msup><msub><mi>h</mi><mi>t</mi></msub></mrow><annotation encoding="application/x-tex"> c_t^{KV} = W^{DKV}h_t</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1.0883em;vertical-align:-0.247em;"></span><span class="mord"><span class="mord mathnormal">c</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.8413em;"><span style="top:-2.453em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">t</span></span></span><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.07153em;">K</span><span class="mord mathnormal mtight" style="margin-right:0.22222em;">V</span></span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.247em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.9913em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.13889em;">W</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8413em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.07153em;">DK</span><span class="mord mathnormal mtight" style="margin-right:0.22222em;">V</span></span></span></span></span></span></span></span></span><span class="mord"><span class="mord mathnormal">h</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.2806em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">t</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span></span><span>ï»¿</span></span>ï¼Œå…¶ä¸­ <style>@import url('https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.16.9/katex.min.css')</style><span data-token-index="0" contenteditable="false" class="notion-text-equation-token" style="user-select:all;-webkit-user-select:all;-moz-user-select:all"><span></span><span><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>d</mi><mrow><mi>l</mi><mi>a</mi><mi>t</mi><mi>e</mi><mi>n</mi><mi>t</mi></mrow></msub><mo>&lt;</mo><msub><mi>d</mi><mrow><mi>m</mi><mi>o</mi><mi>d</mi><mi>e</mi><mi>l</mi></mrow></msub></mrow><annotation encoding="application/x-tex">d_{latent} &lt; d_{model}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8444em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal">d</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3361em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.01968em;">l</span><span class="mord mathnormal mtight">a</span><span class="mord mathnormal mtight">t</span><span class="mord mathnormal mtight">e</span><span class="mord mathnormal mtight">n</span><span class="mord mathnormal mtight">t</span></span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">&lt;</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.8444em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal">d</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3361em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">m</span><span class="mord mathnormal mtight">o</span><span class="mord mathnormal mtight">d</span><span class="mord mathnormal mtight">e</span><span class="mord mathnormal mtight" style="margin-right:0.01968em;">l</span></span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span></span><span>ï»¿</span></span>ï¼Œå…¸å‹å‹ç¼©æ¯”ä¸º 4:1 æˆ– 8:1ã€‚</p><p id="1cf8841f-85ab-808f-b6c7-eea70c3c2084" class="">2ï¸âƒ£ç»´åº¦è¿˜åŸï¼šä½¿ç”¨å‡ç»´çŸ©é˜µ <style>@import url('https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.16.9/katex.min.css')</style><span data-token-index="0" contenteditable="false" class="notion-text-equation-token" style="user-select:all;-webkit-user-select:all;-moz-user-select:all"><span></span><span><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msup><mi>W</mi><mrow><mi>U</mi><mi>K</mi></mrow></msup><mo>âˆˆ</mo><msup><mi mathvariant="double-struck">R</mi><mrow><msub><mi>d</mi><mrow><mi>m</mi><mi>o</mi><mi>d</mi><mi>e</mi><mi>l</mi></mrow></msub><mo>Ã—</mo><msub><mi>d</mi><mrow><mi>l</mi><mi>a</mi><mi>t</mi><mi>e</mi><mi>n</mi><mi>t</mi></mrow></msub></mrow></msup></mrow><annotation encoding="application/x-tex">W^{UK} \in \mathbb{R}^{d_{model} \times d_{latent}}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8804em;vertical-align:-0.0391em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.13889em;">W</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8413em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.10903em;">U</span><span class="mord mathnormal mtight" style="margin-right:0.07153em;">K</span></span></span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">âˆˆ</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.8491em;"></span><span class="mord"><span class="mord mathbb">R</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8491em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight"><span class="mord mathnormal mtight">d</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3448em;"><span style="top:-2.3488em;margin-left:0em;margin-right:0.0714em;"><span class="pstrut" style="height:2.5em;"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">m</span><span class="mord mathnormal mtight">o</span><span class="mord mathnormal mtight">d</span><span class="mord mathnormal mtight">e</span><span class="mord mathnormal mtight" style="margin-right:0.01968em;">l</span></span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.1512em;"><span></span></span></span></span></span></span><span class="mbin mtight">Ã—</span><span class="mord mtight"><span class="mord mathnormal mtight">d</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3448em;"><span style="top:-2.3488em;margin-left:0em;margin-right:0.0714em;"><span class="pstrut" style="height:2.5em;"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.01968em;">l</span><span class="mord mathnormal mtight">a</span><span class="mord mathnormal mtight">t</span><span class="mord mathnormal mtight">e</span><span class="mord mathnormal mtight">n</span><span class="mord mathnormal mtight">t</span></span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.1512em;"><span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span><span>ï»¿</span></span> å’Œ <style>@import url('https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.16.9/katex.min.css')</style><span data-token-index="0" contenteditable="false" class="notion-text-equation-token" style="user-select:all;-webkit-user-select:all;-moz-user-select:all"><span></span><span><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msup><mi>W</mi><mrow><mi>U</mi><mi>V</mi></mrow></msup><mo>âˆˆ</mo><msup><mi mathvariant="double-struck">R</mi><mrow><msub><mi>d</mi><mrow><mi>m</mi><mi>o</mi><mi>d</mi><mi>e</mi><mi>l</mi></mrow></msub><mo>Ã—</mo><msub><mi>d</mi><mrow><mi>l</mi><mi>a</mi><mi>t</mi><mi>e</mi><mi>n</mi><mi>t</mi></mrow></msub></mrow></msup></mrow><annotation encoding="application/x-tex">W^{UV} \in \mathbb{R}^{d_{model} \times d_{latent}}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8804em;vertical-align:-0.0391em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.13889em;">W</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8413em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.10903em;">U</span><span class="mord mathnormal mtight" style="margin-right:0.22222em;">V</span></span></span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">âˆˆ</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.8491em;"></span><span class="mord"><span class="mord mathbb">R</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8491em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight"><span class="mord mathnormal mtight">d</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3448em;"><span style="top:-2.3488em;margin-left:0em;margin-right:0.0714em;"><span class="pstrut" style="height:2.5em;"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">m</span><span class="mord mathnormal mtight">o</span><span class="mord mathnormal mtight">d</span><span class="mord mathnormal mtight">e</span><span class="mord mathnormal mtight" style="margin-right:0.01968em;">l</span></span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.1512em;"><span></span></span></span></span></span></span><span class="mbin mtight">Ã—</span><span class="mord mtight"><span class="mord mathnormal mtight">d</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3448em;"><span style="top:-2.3488em;margin-left:0em;margin-right:0.0714em;"><span class="pstrut" style="height:2.5em;"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.01968em;">l</span><span class="mord mathnormal mtight">a</span><span class="mord mathnormal mtight">t</span><span class="mord mathnormal mtight">e</span><span class="mord mathnormal mtight">n</span><span class="mord mathnormal mtight">t</span></span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.1512em;"><span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span><span>ï»¿</span></span> å°†å‹ç¼©åçš„è¡¨ç¤ºè¿˜åŸåˆ°åŸå§‹ç»´åº¦ï¼š<style>@import url('https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.16.9/katex.min.css')</style><span data-token-index="0" contenteditable="false" class="notion-text-equation-token" style="user-select:all;-webkit-user-select:all;-moz-user-select:all"><span></span><span><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>K</mi><mo>=</mo><msup><mi>W</mi><mrow><mi>U</mi><mi>K</mi></mrow></msup><msubsup><mi>c</mi><mi>t</mi><mrow><mi>K</mi><mi>V</mi></mrow></msubsup><mo separator="true">,</mo><mspace width="1em"/><mi>V</mi><mo>=</mo><msup><mi>W</mi><mrow><mi>U</mi><mi>V</mi></mrow></msup><msubsup><mi>c</mi><mi>t</mi><mrow><mi>K</mi><mi>V</mi></mrow></msubsup></mrow><annotation encoding="application/x-tex">K = W^{UK}c_t^{KV}, \quad V = W^{UV}c_t^{KV}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord mathnormal" style="margin-right:0.07153em;">K</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:1.0883em;vertical-align:-0.247em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.13889em;">W</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8413em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.10903em;">U</span><span class="mord mathnormal mtight" style="margin-right:0.07153em;">K</span></span></span></span></span></span></span></span></span><span class="mord"><span class="mord mathnormal">c</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.8413em;"><span style="top:-2.453em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">t</span></span></span><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.07153em;">K</span><span class="mord mathnormal mtight" style="margin-right:0.22222em;">V</span></span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.247em;"><span></span></span></span></span></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right:1em;"></span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord mathnormal" style="margin-right:0.22222em;">V</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:1.0883em;vertical-align:-0.247em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.13889em;">W</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8413em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.10903em;">U</span><span class="mord mathnormal mtight" style="margin-right:0.22222em;">V</span></span></span></span></span></span></span></span></span><span class="mord"><span class="mord mathnormal">c</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.8413em;"><span style="top:-2.453em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">t</span></span></span><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.07153em;">K</span><span class="mord mathnormal mtight" style="margin-right:0.22222em;">V</span></span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.247em;"><span></span></span></span></span></span></span></span></span></span></span><span>ï»¿</span></span>.</p><p id="1ac8841f-85ab-80ba-beec-f263cc3d07cb" class="">MLA åœ¨é™ä½æ˜¾å­˜çš„åŒæ—¶å¯ä»¥æ‰©å¤§ä¸Šä¸‹æ–‡çš„çª—å£ã€‚</p><p id="1cf8841f-85ab-8004-b535-e202974d1377" class="">MLAæ”¹è¿›åçš„è®¡ç®—è¿‡ç¨‹ï¼š<br/>1. Latent Projection: <br/><style>@import url('https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.16.9/katex.min.css')</style><span data-token-index="0" contenteditable="false" class="notion-text-equation-token" style="user-select:all;-webkit-user-select:all;-moz-user-select:all"><span></span><span><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>K</mi><mrow><mi>l</mi><mi>a</mi><mi>t</mi><mi>e</mi><mi>n</mi><mi>t</mi></mrow></msub><mo>=</mo><msup><mi>W</mi><mrow><mi>D</mi><mi>K</mi><mi>V</mi></mrow></msup><mi>K</mi><mo separator="true">,</mo><mspace width="1em"/><msub><mi>V</mi><mrow><mi>l</mi><mi>a</mi><mi>t</mi><mi>e</mi><mi>n</mi><mi>t</mi></mrow></msub><mo>=</mo><msup><mi>W</mi><mrow><mi>D</mi><mi>K</mi><mi>V</mi></mrow></msup><mi>V</mi></mrow><annotation encoding="application/x-tex">K_{latent} = W^{DKV}K, \quad V_{latent} = W^{DKV}V</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8333em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.07153em;">K</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3361em;"><span style="top:-2.55em;margin-left:-0.0715em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.01968em;">l</span><span class="mord mathnormal mtight">a</span><span class="mord mathnormal mtight">t</span><span class="mord mathnormal mtight">e</span><span class="mord mathnormal mtight">n</span><span class="mord mathnormal mtight">t</span></span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:1.0358em;vertical-align:-0.1944em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.13889em;">W</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8413em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.07153em;">DK</span><span class="mord mathnormal mtight" style="margin-right:0.22222em;">V</span></span></span></span></span></span></span></span></span><span class="mord mathnormal" style="margin-right:0.07153em;">K</span><span class="mpunct">,</span><span class="mspace" style="margin-right:1em;"></span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.22222em;">V</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3361em;"><span style="top:-2.55em;margin-left:-0.2222em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.01968em;">l</span><span class="mord mathnormal mtight">a</span><span class="mord mathnormal mtight">t</span><span class="mord mathnormal mtight">e</span><span class="mord mathnormal mtight">n</span><span class="mord mathnormal mtight">t</span></span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.8413em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.13889em;">W</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8413em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.07153em;">DK</span><span class="mord mathnormal mtight" style="margin-right:0.22222em;">V</span></span></span></span></span></span></span></span></span><span class="mord mathnormal" style="margin-right:0.22222em;">V</span></span></span></span></span><span>ï»¿</span></span><br/>2. Attention Computation: <br/><style>@import url('https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.16.9/katex.min.css')</style><span data-token-index="0" contenteditable="false" class="notion-text-equation-token" style="user-select:all;-webkit-user-select:all;-moz-user-select:all"><span></span><span><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>A</mi><mo>=</mo><mi>s</mi><mi>o</mi><mi>f</mi><mi>t</mi><mi>m</mi><mi>a</mi><mi>x</mi><mrow><mo fence="true">(</mo><mfrac><mrow><mi>Q</mi><mo stretchy="false">(</mo><msub><mi>K</mi><mrow><mi>l</mi><mi>a</mi><mi>t</mi><mi>e</mi><mi>n</mi><mi>t</mi></mrow></msub><msup><mo stretchy="false">)</mo><mi>T</mi></msup></mrow><msqrt><msub><mi>d</mi><mrow><mi>l</mi><mi>a</mi><mi>t</mi><mi>e</mi><mi>n</mi><mi>t</mi></mrow></msub></msqrt></mfrac><mo fence="true">)</mo></mrow></mrow><annotation encoding="application/x-tex">  A = softmax\left(\frac{Q (K_{latent})^T}{\sqrt{d_{latent}}}\right)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord mathnormal">A</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:1.8em;vertical-align:-0.65em;"></span><span class="mord mathnormal">so</span><span class="mord mathnormal" style="margin-right:0.10764em;">f</span><span class="mord mathnormal">t</span><span class="mord mathnormal">ma</span><span class="mord mathnormal">x</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="minner"><span class="mopen delimcenter" style="top:0em;"><span class="delimsizing size2">(</span></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.1284em;"><span style="top:-2.5864em;"><span class="pstrut" style="height:3em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord sqrt mtight"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.8622em;"><span class="svg-align" style="top:-3em;"><span class="pstrut" style="height:3em;"></span><span class="mord mtight" style="padding-left:0.833em;"><span class="mord mtight"><span class="mord mathnormal mtight">d</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3448em;"><span style="top:-2.3488em;margin-left:0em;margin-right:0.0714em;"><span class="pstrut" style="height:2.5em;"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.01968em;">l</span><span class="mord mathnormal mtight">a</span><span class="mord mathnormal mtight">t</span><span class="mord mathnormal mtight">e</span><span class="mord mathnormal mtight">n</span><span class="mord mathnormal mtight">t</span></span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.1512em;"><span></span></span></span></span></span></span></span></span><span style="top:-2.8222em;"><span class="pstrut" style="height:3em;"></span><span class="hide-tail mtight" style="min-width:0.853em;height:1.08em;"><svg xmlns="http://www.w3.org/2000/svg" width='400em' height='1.08em' viewBox='0 0 400000 1080' preserveAspectRatio='xMinYMin slice'><path d='M95,702
c-2.7,0,-7.17,-2.7,-13.5,-8c-5.8,-5.3,-9.5,-10,-9.5,-14
c0,-2,0.3,-3.3,1,-4c1.3,-2.7,23.83,-20.7,67.5,-54
c44.2,-33.3,65.8,-50.3,66.5,-51c1.3,-1.3,3,-2,5,-2c4.7,0,8.7,3.3,12,10
s173,378,173,378c0.7,0,35.3,-71,104,-213c68.7,-142,137.5,-285,206.5,-429
c69,-144,104.5,-217.7,106.5,-221
l0 -0
c5.3,-9.3,12,-14,20,-14
H400000v40H845.2724
s-225.272,467,-225.272,467s-235,486,-235,486c-2.7,4.7,-9,7,-19,7
c-6,0,-10,-1,-12,-3s-194,-422,-194,-422s-65,47,-65,47z
M834 80h400000v40h-400000z'/></svg></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.1778em;"><span></span></span></span></span></span></span></span></span><span style="top:-3.23em;"><span class="pstrut" style="height:3em;"></span><span class="frac-line" style="border-bottom-width:0.04em;"></span></span><span style="top:-3.485em;"><span class="pstrut" style="height:3em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">Q</span><span class="mopen mtight">(</span><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.07153em;">K</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3448em;"><span style="top:-2.3488em;margin-left:-0.0715em;margin-right:0.0714em;"><span class="pstrut" style="height:2.5em;"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.01968em;">l</span><span class="mord mathnormal mtight">a</span><span class="mord mathnormal mtight">t</span><span class="mord mathnormal mtight">e</span><span class="mord mathnormal mtight">n</span><span class="mord mathnormal mtight">t</span></span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.1512em;"><span></span></span></span></span></span></span><span class="mclose mtight"><span class="mclose mtight">)</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.9191em;"><span style="top:-2.931em;margin-right:0.0714em;"><span class="pstrut" style="height:2.5em;"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mathnormal mtight" style="margin-right:0.13889em;">T</span></span></span></span></span></span></span></span></span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.538em;"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span><span class="mclose delimcenter" style="top:0em;"><span class="delimsizing size2">)</span></span></span></span></span></span></span><span>ï»¿</span></span><br/>3. Value Aggregation:  <br/><style>@import url('https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.16.9/katex.min.css')</style><span data-token-index="0" contenteditable="false" class="notion-text-equation-token" style="user-select:all;-webkit-user-select:all;-moz-user-select:all"><span></span><span><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>O</mi><mo>=</mo><mi>A</mi><msub><mi>V</mi><mrow><mi>l</mi><mi>a</mi><mi>t</mi><mi>e</mi><mi>n</mi><mi>t</mi></mrow></msub><mo stretchy="false">(</mo><msup><mi>W</mi><mrow><mi>U</mi><mi>V</mi></mrow></msup><msup><mo stretchy="false">)</mo><mi>T</mi></msup></mrow><annotation encoding="application/x-tex">O = A V_{latent} (W^{UV})^T</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord mathnormal" style="margin-right:0.02778em;">O</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:1.0913em;vertical-align:-0.25em;"></span><span class="mord mathnormal">A</span><span class="mord"><span class="mord mathnormal" style="margin-right:0.22222em;">V</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3361em;"><span style="top:-2.55em;margin-left:-0.2222em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.01968em;">l</span><span class="mord mathnormal mtight">a</span><span class="mord mathnormal mtight">t</span><span class="mord mathnormal mtight">e</span><span class="mord mathnormal mtight">n</span><span class="mord mathnormal mtight">t</span></span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mopen">(</span><span class="mord"><span class="mord mathnormal" style="margin-right:0.13889em;">W</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8413em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.10903em;">U</span><span class="mord mathnormal mtight" style="margin-right:0.22222em;">V</span></span></span></span></span></span></span></span></span><span class="mclose"><span class="mclose">)</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8413em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.13889em;">T</span></span></span></span></span></span></span></span></span></span></span></span><span>ï»¿</span></span></p><h2 id="1ac8841f-85ab-8093-a9e1-d20c95f4857e" class="">LLaMA æ¶æ„</h2><h3 id="1b38841f-85ab-8027-9659-e332fda70253" class="">Architecture</h3><ol type="1" id="1b38841f-85ab-8076-b68f-cbcdfa2a3f5c" class="numbered-list" start="1"><li>RSM Norm æå‰ï¼ˆä¹‹å‰ä½¿ç”¨Layer Normalizationï¼‰<ol type="a" id="1b38841f-85ab-80ad-be83-c7e0b6e826ec" class="numbered-list" start="1"><li>RMSNorm è®¡ç®—çš„æ•ˆç‡æ›´é«˜</li></ol><figure id="1b38841f-85ab-8003-beb8-c74017a8662c" class="image"><a href="image%2013.png"><img style="width:576px" src="image%2013.png"/></a></figure></li></ol><ol type="1" id="1b38841f-85ab-80c4-9d47-f608b9eca8ec" class="numbered-list" start="2"><li>Position Embedding<p id="1b38841f-85ab-80bb-86b2-c8cdd532b894" class="">Transformerå¯ä»¥æ•æ‰ token ä¹‹é—´çš„å…³ç³»ï¼Œä½†æ˜¯ä¸å¯ä»¥æ³¨æ„åˆ°è¾“å…¥çš„é¡ºåºã€‚å¯ä»¥è®¡ç®— PE(pos) å’Œ PE(pos+k)</p><figure id="1b38841f-85ab-80fb-9049-f33f49d70640" class="image"><a href="image%2014.png"><img style="width:528px" src="image%2014.png"/></a></figure><p id="1b38841f-85ab-8088-9fb4-d2ee8a84e316" class="">Input=word embedding + Position embedding</p><p id="1b38841f-85ab-801f-8a4a-df7a0db132ec" class="">ç»å¯¹ä½ç½®ç¼–ç å’Œç›¸å¯¹ä½ç½®ç¼–ç ï¼šç»å¯¹ä½ç½®ç¼–ç åªå¤„ç†ç‰¹å®šä¸€ä¸ªå•è¯ï¼›ç›¸å¯¹ä½ç½®ç¼–ç ï¼šåœ¨è®¡ç®—ä¸€ä¸ªå•è¯çš„ QK æ—¶è€ƒè™‘ä¸¤ä¸ªå•è¯çš„ç›¸å¯¹ä½ç½® <mark class="highlight-blue"><style>@import url('https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.16.9/katex.min.css')</style><span data-token-index="0" contenteditable="false" class="notion-text-equation-token" style="user-select:all;-webkit-user-select:all;-moz-user-select:all"><span></span><span><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>e</mi><mrow><mi>i</mi><mi>j</mi></mrow></msub><mo>=</mo><mstyle displaystyle="true" scriptlevel="0"><mfrac><mrow><msub><mi>x</mi><mi>i</mi></msub><msup><mi>W</mi><mi>Q</mi></msup><mo stretchy="false">(</mo><msub><mi>x</mi><mi>j</mi></msub><msup><mi>W</mi><mi>K</mi></msup><mo>+</mo><msubsup><mi>a</mi><mrow><mi>i</mi><mi>j</mi></mrow><mi>K</mi></msubsup><msup><mo stretchy="false">)</mo><mi>T</mi></msup></mrow><msqrt><msub><mi>d</mi><mi>z</mi></msub></msqrt></mfrac></mstyle></mrow><annotation encoding="application/x-tex">e_{ij}=\dfrac{x_iW^Q(x_jW^K+a_{ij}^K)^T}{\sqrt{d_z}}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.7167em;vertical-align:-0.2861em;"></span><span class="mord"><span class="mord mathnormal">e</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3117em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.05724em;">ij</span></span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.2861em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:2.5561em;vertical-align:-0.93em;"></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.6261em;"><span style="top:-2.2528em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord sqrt"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.8572em;"><span class="svg-align" style="top:-3em;"><span class="pstrut" style="height:3em;"></span><span class="mord" style="padding-left:0.833em;"><span class="mord"><span class="mord mathnormal">d</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.1514em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.04398em;">z</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span><span style="top:-2.8172em;"><span class="pstrut" style="height:3em;"></span><span class="hide-tail" style="min-width:0.853em;height:1.08em;"><svg xmlns="http://www.w3.org/2000/svg" width='400em' height='1.08em' viewBox='0 0 400000 1080' preserveAspectRatio='xMinYMin slice'><path d='M95,702
c-2.7,0,-7.17,-2.7,-13.5,-8c-5.8,-5.3,-9.5,-10,-9.5,-14
c0,-2,0.3,-3.3,1,-4c1.3,-2.7,23.83,-20.7,67.5,-54
c44.2,-33.3,65.8,-50.3,66.5,-51c1.3,-1.3,3,-2,5,-2c4.7,0,8.7,3.3,12,10
s173,378,173,378c0.7,0,35.3,-71,104,-213c68.7,-142,137.5,-285,206.5,-429
c69,-144,104.5,-217.7,106.5,-221
l0 -0
c5.3,-9.3,12,-14,20,-14
H400000v40H845.2724
s-225.272,467,-225.272,467s-235,486,-235,486c-2.7,4.7,-9,7,-19,7
c-6,0,-10,-1,-12,-3s-194,-422,-194,-422s-65,47,-65,47z
M834 80h400000v40h-400000z'/></svg></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.1828em;"><span></span></span></span></span></span></span></span><span style="top:-3.23em;"><span class="pstrut" style="height:3em;"></span><span class="frac-line" style="border-bottom-width:0.04em;"></span></span><span style="top:-3.7848em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord"><span class="mord mathnormal">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3117em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">i</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.13889em;">W</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8413em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">Q</span></span></span></span></span></span></span></span><span class="mopen">(</span><span class="mord"><span class="mord mathnormal">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3117em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.05724em;">j</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.2861em;"><span></span></span></span></span></span></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.13889em;">W</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8413em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.07153em;">K</span></span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mord"><span class="mord mathnormal">a</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.8413em;"><span style="top:-2.4413em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.05724em;">ij</span></span></span></span><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.07153em;">K</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.3948em;"><span></span></span></span></span></span></span><span class="mclose"><span class="mclose">)</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8413em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.13889em;">T</span></span></span></span></span></span></span></span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.93em;"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span></span></span></span></span><span>ï»¿</span></span></mark></p></li></ol><ol type="1" id="1b38841f-85ab-8086-81dd-fb18e7140026" class="numbered-list" start="3"><li> <em><strong>ROPE Position Embedding</strong></em><figure id="1b38841f-85ab-80da-b64c-efbc0b7a751d" class="image"><a href="image%2015.png"><img style="width:672px" src="image%2015.png"/></a></figure><ol type="1" id="1b38841f-85ab-8047-9579-d4b484014559" class="numbered-list" start="1"><li>æ‰¾åˆ°ä¸€ç§å†…ç§¯ï¼Œä½œç”¨äºæ³¨æ„åŠ›æœºåˆ¶ä¸­ä½¿ç”¨çš„ä¸¤ä¸ªå‘é‡ qï¼ˆæŸ¥è¯¢ï¼‰å’Œ kï¼ˆé”®ï¼‰ï¼Œä½¿å…¶åªä¾<br/>èµ–äºè¿™ä¸¤ä¸ªå‘é‡å’Œå®ƒä»¬æ‰€ä»£è¡¨çš„è¯å…ƒä¹‹é—´çš„ç›¸å¯¹è·ç¦»<br/></li></ol><ol type="1" id="1b38841f-85ab-806d-8344-c186de9e8b76" class="numbered-list" start="2"><li>åŸºäºæåæ ‡ï¼Œå¯ä»¥å‡å°‘è¿ç®—é‡ï¼ŒåŒæ—¶ç”¨æ—‹è½¬çŸ©é˜µåˆ»ç”»ä½ç½®ã€‚</li></ol><ol type="1" id="1b38841f-85ab-804e-803a-f782b2d3b4bb" class="numbered-list" start="3"><li>ç”¨æ—‹è½¬å‘é‡æ¥ç†è§£ RoPEï¼Œå‘é‡æ—‹è½¬è§’åº¦ç”± <style>@import url('https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.16.9/katex.min.css')</style><span data-token-index="0" contenteditable="false" class="notion-text-equation-token" style="user-select:all;-webkit-user-select:all;-moz-user-select:all"><span></span><span><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>Î¸</mi></mrow><annotation encoding="application/x-tex">\theta</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6944em;"></span><span class="mord mathnormal" style="margin-right:0.02778em;">Î¸</span></span></span></span></span><span>ï»¿</span></span> å’Œ m å†³å®šã€‚å…¶ä¸­ <style>@import url('https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.16.9/katex.min.css')</style><span data-token-index="0" contenteditable="false" class="notion-text-equation-token" style="user-select:all;-webkit-user-select:all;-moz-user-select:all"><span></span><span><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>Î¸</mi></mrow><annotation encoding="application/x-tex">\theta </annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6944em;"></span><span class="mord mathnormal" style="margin-right:0.02778em;">Î¸</span></span></span></span></span><span>ï»¿</span></span>æ˜¯å¢åŠ ç¼–ç å¤šæ ·æ€§çš„å‚æ•°ï¼Œm æ˜¯token çš„ä½ç½®ã€‚</li></ol><ol type="1" id="1b38841f-85ab-800f-9017-c07e21334ff7" class="numbered-list" start="4"><li>è®­ç»ƒæ—¶å¤§éƒ¨åˆ†è¾“å…¥ä½¿ç”¨å°çª—å£ï¼Œä¹‹åä½¿ç”¨é•¿æ–‡æœ¬å¾®è°ƒã€‚</li></ol><ol type="1" id="1b38841f-85ab-809e-aee2-d1b3bd1c3869" class="numbered-list" start="5"><li>æ‹‰é•¿çª—å£çš„å…¶ä»–æ–¹æ³•ï¼šMemory Replayï¼›Attention å»¶å±•ï¼›Sliding Window Attention</li></ol></li></ol><h3 id="1b38841f-85ab-80e1-92f2-e1bc9ae77bde" class="">KV cache</h3><p id="1b38841f-85ab-8009-864e-c7a78e136b05" class="">ä¹‹å‰è®¡ç®—è¿‡çš„å•è¯çš„ K å’Œ V ä¸ç”¨å†æ¬¡è®¡ç®—ä¸€éã€‚ By caching the previous Keys and Values, we can focus on only calculating the attention for the new token.</p><p id="1b38841f-85ab-80c2-ac22-d04a54d6be91" class="">ç°è±¡ï¼š deepseek ç¬¬ä¸€ä¸ªå•è¯ç”Ÿæˆæ¯”è¾ƒæ…¢ã€‚æŸå¤±æ˜¾å­˜è¾¾åˆ°åŠ é€Ÿçš„ç›®çš„â€”â€”ç©ºé—´æ¢æ—¶é—´ã€‚æ‰€ä»¥ç›®å‰æ˜¾å¡å¢å¤§çš„ç›®çš„ï¼šå‚¨å­˜æ¨¡å‹å‚æ•°ï¼›å‚¨å­˜ KV cacheã€‚</p><p id="1b38841f-85ab-8099-be1f-c51b08243505" class="">KV cache ä½¿ç”¨ä¸å½“ä¼šé€ æˆé¢„ç•™ç©ºé—´ï¼›å†…éƒ¨å’Œå¤–éƒ¨ç¢ç‰‡çš„é—®é¢˜ã€‚</p><figure id="1b38841f-85ab-8021-b9a0-c9eee6332f3f" class="image"><a href="image%2016.png"><img style="width:709.990478515625px" src="image%2016.png"/></a></figure><p id="1b38841f-85ab-8004-8c53-cf1b57d47d61" class="">è§£å†³ï¼š<strong>Page Attention</strong></p><p id="1b38841f-85ab-8073-b668-e847459d70d1" class="">ä½¿ç”¨ä¸€ä¸ª KV-cache çš„ managerï¼ˆç±»æ¯”è®¡ç®—æœºç³»ç»Ÿä¸­çš„é¡µè¡¨ï¼‰</p><figure id="1b38841f-85ab-8026-b263-eed8252c96bb" class="image"><a href="a263314a-513c-4269-bb8e-475424806f67.png"><img style="width:720px" src="a263314a-513c-4269-bb8e-475424806f67.png"/></a></figure><p id="1b38841f-85ab-805e-b8ec-f74d79574d1e" class=""><strong>vLLM </strong>ä½¿ç”¨å¸¦æœ‰Page Attention çš„ KV cache </p><h3 id="1b38841f-85ab-8069-b8e6-f79bf8c54c98" class="">é€šè®¯å’Œå­˜å‚¨å¢™</h3><p id="1b38841f-85ab-805f-a2cd-fe23576ffcea" class="">å¯¹åŒä¸€ä¸ªå¼ é‡æ‰§è¡Œç›¸åŒçš„æ“ä½œ N æ¬¡ï¼Œå¯èƒ½æ¯”å¯¹ N ä¸ªä¸åŒçš„å¼ é‡æ‰§è¡Œç›¸åŒçš„æ“ä½œæ›´å¿«ï¼Œå³ä½¿å®ƒä»¬çš„å¤§å°ç›¸åŒï¼Œè¿™æ˜¯å› ä¸º GPU å¯èƒ½éœ€è¦ç§»åŠ¨è¿™äº›å¼ é‡ã€‚è¿™æ„å‘³ç€æˆ‘ä»¬çš„ç›®æ ‡ä¸ä»…æ˜¯ä¼˜åŒ–æ“ä½œçš„æ•°é‡ï¼Œè¿˜è¦å°½é‡å‡å°‘å†…å­˜è®¿é—®æˆ–ä¼ è¾“çš„æ¬¡æ•°ã€‚</p><p id="1b38841f-85ab-8035-8837-e5170f2c63cc" class="">å¯¹äºä¸å­˜å‚¨å™¨çš„é€šè®¯æŸè€—ï¼šæœ‰æ—¶å€™ä¸å‚¨å­˜æ¢¯åº¦ï¼Œåœ¨éœ€è¦æ—¶åˆ©ç”¨ activation function è®¡ç®—ã€‚</p><p id="1b38841f-85ab-80b6-979e-f3050911e8de" class="">åœ¨å®é™…ä¸­å‘ç°ï¼šå­˜å‚¨å¸¦å®½é™åˆ¶è€Œä¸æ˜¯è®¡ç®—é€Ÿåº¦é™åˆ¶ã€‚</p><figure id="1b38841f-85ab-803c-8f42-de9a83b7a2b1" class="image"><a href="image%2017.png"><img style="width:709.990478515625px" src="image%2017.png"/></a></figure><h3 id="1b38841f-85ab-80ae-a138-f51a64459c85" class="">Multi-head Attention+KV cache</h3><p id="1b38841f-85ab-80ef-8da3-d61b467b77f9" class="">AI è¿œå°äº 1ï¼Œè¿™æ ·å¸¦æ¥ä¸¥é‡çš„å­˜å‚¨å¢™é—®é¢˜ï¼Œè§£å†³ï¼š<mark class="highlight-pink"><strong>Multi-query Attentionï¼š</strong></mark></p><figure id="1b38841f-85ab-8008-bf65-e4b16c28da32" class="image"><a href="image%2018.png"><img style="width:672px" src="image%2018.png"/></a></figure><p id="1b38841f-85ab-80e2-9824-eb1f753299b6" class="">æ€è·¯ï¼šå¤åˆ¶ K å’Œ Vï¼Œä½†æ˜¯ä½¿ç”¨å¤šä¸ª Qï¼Œä¿è¯å¤šä¸ªå¤´çš„ä½œç”¨ã€‚</p><p id="1b38841f-85ab-80c8-8520-c3e8024a52bf" class=""><mark class="highlight-pink"><strong>Group-query Attention</strong></mark>: åœ¨ä¿è¯æ€§èƒ½çš„åŒæ—¶æé«˜é€Ÿåº¦ï¼Œå…±ç”¨ K å’Œ V</p><figure id="1b38841f-85ab-8034-a9cf-f5c829811727" class="image"><a href="image%2019.png"><img style="width:720px" src="image%2019.png"/></a></figure><h3 id="1b38841f-85ab-8011-9358-d4beff7a1955" class="">SwiGLU Activation Function</h3><figure id="1b38841f-85ab-807c-9ca6-e724e6b74a1f" class="image"><a href="image%2020.png"><img style="width:709.9826049804688px" src="image%2020.png"/></a></figure><h2 id="1b38841f-85ab-8085-a717-ef3aaa143f48" class="">æ¨ç†ç°è±¡</h2><h3 id="1b38841f-85ab-8035-ba48-e61264d91f7a" class="">Emergent Capability</h3><p id="1b38841f-85ab-80fd-9a78-ec2a17b7a995" class="">Emergence is when quantitative changes in a system result in qualitative changes in behavior.è¿™ç§ç°è±¡é€šå¸¸æ˜¯ç›¸å˜ï¼Œä¸å¯é¢„æµ‹ï¼Œä¸”â€œå°–é”â€ï¼ˆä¸ y è½´é€‰æ‹©æœ‰å…³ï¼‰</p><ol type="1" id="1b38841f-85ab-8008-8243-d87ada477388" class="numbered-list" start="1"><li>åœ¨è®¾ç½®æ¨¡å‹çš„ reward æ—¶ï¼Œå¦‚æœä½¿ç”¨æˆåŠŸä¸º 1ï¼Œå¦åˆ™ä¸º0ã€‚è¿™æ ·çš„éè¿ç»­æ€§åº¦é‡å¯¼è‡´æ¶Œç°ã€‚</li></ol><ol type="1" id="1b38841f-85ab-8085-9331-cf92a37ddc54" class="numbered-list" start="2"><li>Token Edit Distance ä½œä¸ºè¯„æµ‹æŒ‡æ ‡ï¼ŒTED æ˜¯é€æ¸é™ä½çš„ï¼Œè¯´æ˜æ¶Œç°å¯èƒ½å¹¶ä¸æ˜¯ Scaling law äº§ç”Ÿçš„ç°è±¡ã€‚</li></ol><h3 id="1b38841f-85ab-80b2-812a-ed8837303ae8" class="">The grokking effect (é¢†æ‚ŸåŠ›)</h3><p id="1b38841f-85ab-80c9-99aa-e8de4686b26c" class="">This phenomenon â€“ where generalization seems to happen abruptly and long after fitting the training data â€“ is called grokking.</p><figure id="1b38841f-85ab-80d3-afd8-c8702888182b" class="image"><a href="image%2021.png"><img style="width:709.9589233398438px" src="image%2021.png"/></a></figure><h3 id="1b38841f-85ab-80c9-910f-e5930d352260" class="">The double descent</h3><p id="1b38841f-85ab-8093-8234-c61cacfcd51c" class="">Double Descent çš„ç°è±¡è¡¨æ˜ï¼Œåœ¨æ¨¡å‹å®¹é‡ç»§ç»­å¢åŠ æ—¶ï¼Œè¯¯å·®æ›²çº¿ä¼šå†æ¬¡ä¸‹é™ï¼Œå½¢æˆç¬¬äºŒæ¬¡ä¸‹é™ã€‚è¿™â¼€ç°è±¡æ‰“ç ´äº†ä¼ ç»Ÿçš„åå·®-æ–¹å·®æƒè¡¡ç†è®ºï¼Œåœ¨æ¨¡å‹å®¹é‡å¤§åˆ°ä¸€å®šç¨‹åº¦åï¼Œå¢åŠ æ¨¡å‹çš„å¤æ‚æ€§ä¸ä»…ä¸ä¼šå¯¼è‡´è¿‡æ‹Ÿåˆï¼Œåâ½½å¯ä»¥æ”¹å–„æ³›åŒ–æ€§èƒ½ã€‚</p><h2 id="1b38841f-85ab-8002-8d90-c30871d77161" class="">Pretrain</h2><p id="1cf8841f-85ab-8005-97b0-f973959ea18c" class="">æ€ç»´å¯¼å›¾ï¼š</p><div id="1b38841f-85ab-80f1-b08e-d5d71f9f67bd" class="column-list"><div id="1b38841f-85ab-80b7-bff6-c1ea3b049b47" style="width:56.25%" class="column"><figure id="1b38841f-85ab-8028-8ba5-d6a6d71ab909" class="image"><a href="image%2022.png"><img style="width:709.9826049804688px" src="image%2022.png"/></a></figure></div><div id="1b38841f-85ab-80d1-b754-f4ca9b608dc4" style="width:43.75000000000001%" class="column"><figure id="1b38841f-85ab-806a-9bb9-d247dc90c260" class="image"><a href="image%2023.png"><img style="width:331.98388671875px" src="image%2023.png"/></a></figure><p id="1b38841f-85ab-8066-9a11-f3090fdf4e16" class=""><strong>Procedure</strong></p></div></div><p id="1b38841f-85ab-806b-9ea7-c8f406cfa255" class="">ä»»åŠ¡ï¼šè‡ªå›å½’</p><figure id="1b38841f-85ab-805a-85ef-cdf1860ca35b" class="image"><a href="image%2024.png"><img style="width:720px" src="image%2024.png"/></a></figure><h2 id="1b38841f-85ab-80e5-871c-e7091cce782e" class="">Tokenizer</h2><p id="1b38841f-85ab-804d-9465-ce267fb30e2e" class="">æ‰¾åˆ°ä¸€ç§æ›´å¥½çš„è¡¨å¾è¯æ ¹çš„æ–¹å¼ã€‚ä¸€ä¸ªå•è¯é€šå¸¸æ˜¯ 3.5-4 ä¸ªtoken</p><p id="1b38841f-85ab-80c6-a6cc-e29095a23fff" class="">å®é™…æ“ä½œï¼šTokenizer with paddingï¼šå°†å­—æ•°ä¸åŒçš„å¥å­paddingæˆä¸€æ ·é•¿çš„ã€‚</p><h3 id="1b38841f-85ab-806c-bd3d-d18cc7e1fab1" class="">BPEï¼šByte Pair Encoding</h3><ol type="1" id="1b38841f-85ab-8000-92ab-f22586346b0f" class="numbered-list" start="1"><li>å°†æ–‡æœ¬æ‹†åˆ†ä¸ºå•ä¸ªå­—ç¬¦</li></ol><ol type="1" id="1b38841f-85ab-8015-8de0-ec6b0b481025" class="numbered-list" start="2"><li>ç»Ÿè®¡å­—ç¬¦å¯¹é¢‘ç‡ï¼ˆé€šå¸¸ä¸ºç›¸é‚»çš„å­—ç¬¦ï¼‰</li></ol><ol type="1" id="1b38841f-85ab-8052-b574-fb9fbb083a7e" class="numbered-list" start="3"><li>è¿­ä»£åˆå¹¶é«˜é¢‘å­—ç¬¦å¯¹</li></ol><ol type="1" id="1b38841f-85ab-8054-be21-c536dc479f55" class="numbered-list" start="4"><li>ç»§ç»­åˆå¹¶ï¼Œæ„å»ºå­è¯</li></ol><ol type="1" id="1b38841f-85ab-80ce-8ae7-c3013b0f9d88" class="numbered-list" start="5"><li>å¤„ç†å¤åˆè¯ï¼Œå°†ä¸€ä¸ªè¯æ‹†åˆ†ä¸ºå·²æœ‰ token</li></ol><ol type="1" id="1b38841f-85ab-804e-8daf-dda0e1676def" class="numbered-list" start="6"><li>è·å¾—è¯æ±‡è¡¨</li></ol><ol type="1" id="1b38841f-85ab-80ed-a5d0-e4dfdccfd47c" class="numbered-list" start="7"><li>å°†æ–‡æœ¬æ˜ å°„ä¸º token ç´¢å¼•</li></ol><p id="1b38841f-85ab-80c0-957e-ea9b021f82b9" class="">ä¸åŒè®­ç»ƒè¯­æ–™åˆæˆçš„å­—å…¸ä¸åŒï¼š</p><figure id="1b38841f-85ab-80e1-8d26-ded95452072e" class="image"><a href="1bb5eb98-33d4-4154-a9f1-e0ef1a6e27a7.png"><img style="width:768px" src="1bb5eb98-33d4-4154-a9f1-e0ef1a6e27a7.png"/></a></figure><p id="1cf8841f-85ab-8014-8b27-f27feb8315f6" class="">ä¸åŒçš„ç¼–ç æ–¹å¼ï¼š</p><p id="1b38841f-85ab-801c-b4bd-c285a0b28142" class="">Unicodeï¼šæ›´å®¹æ˜“äººç±»ç†è§£ï¼Œä½†æ˜¯è¯­æ–™åº“å·¨å¤§ï¼ŒåŸå§‹å‚¨å­˜çš„vocab å¯èƒ½ä¹Ÿæ¯”è¾ƒå¤§ã€‚</p><p id="1b38841f-85ab-80a5-a21e-feea77bd3bc0" class="">Byte çš„å­˜å‚¨æ•ˆç‡æ›´é«˜ï¼ˆåŸºç¡€åªéœ€è¦ 256 ç§tokenï¼‰ï¼Œunicode æ— æ³•å¤„ç†æœªè§è¿‡çš„å­—ç¬¦ã€‚GPT ä½¿ç”¨ BPEã€‚</p><p id="1b38841f-85ab-803b-97c7-d16a8df18e8c" class="">ç›¸æ¯”äº BPEï¼ŒWordPiece æ˜¯ä¸€ç§å¸¸ç”¨çš„å­è¯åˆ†è¯ï¼ˆSubword Tokenizationï¼‰ç®—æ³•ï¼Œå¹¿æ³›åº”ç”¨äºè‡ªç„¶è¯­è¨€å¤„ç†ï¼ˆNLPï¼‰ä»»åŠ¡ä¸­ï¼Œå°¤å…¶æ˜¯åœ¨ BERT ç­‰ Transformer æ¨¡å‹ä¸­ã€‚å®ƒçš„æ ¸å¿ƒæ€æƒ³æ˜¯å°†å•è¯æ‹†åˆ†ä¸ºæ›´å°çš„å­è¯å•å…ƒï¼Œä»è€Œè§£å†³æœªç™»å½•è¯ï¼ˆOut-of-Vocabulary, OOVï¼‰é—®é¢˜ï¼Œå¹¶å‡å°‘è¯æ±‡è¡¨çš„å¤§å°ã€‚</p><ul id="1b38841f-85ab-80fa-9cc2-eb6d2642c1d3" class="bulleted-list"><li style="list-style-type:disc">BPEï¼šåŸºäºé¢‘ç‡æœ€é«˜çš„å­è¯å¯¹è¿›è¡Œåˆå¹¶ã€‚</li></ul><ul id="1b38841f-85ab-8001-9a0f-ca56abbe68db" class="bulleted-list"><li style="list-style-type:disc">WordPieceï¼šåŸºäºæœ€å¤§åŒ–è¯­è¨€æ¨¡å‹çš„ä¼¼ç„¶æ¦‚ç‡è¿›è¡Œåˆå¹¶ã€‚</li></ul><h2 id="1b38841f-85ab-808b-8493-dff3a326263d" class="">Evaluation</h2><h3 id="1b38841f-85ab-807c-a7b0-f7d3dd5ffa67" class="">Perplexityï¼ˆå›°æƒ‘åº¦ï¼‰</h3><p id="1b38841f-85ab-80f6-a4ab-ce90a84a906a" class="">æ¯ä¸ª token è¾“å‡ºæ—¶åˆ°åº•æœ‰å¤šä¹ˆä¸ç¡®å®šï¼Œå€ŸåŠ©ç†µï¼š<style>@import url('https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.16.9/katex.min.css')</style><span data-token-index="0" contenteditable="false" class="notion-text-equation-token" style="user-select:all;-webkit-user-select:all;-moz-user-select:all"><span></span><span><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>P</mi><mi>e</mi><mi>r</mi><mi>p</mi><mi>l</mi><mi>e</mi><mi>x</mi><mi>i</mi><mi>t</mi><mi>y</mi><mo>=</mo><msup><mn>2</mn><mrow><mi>H</mi><mo stretchy="false">(</mo><mi>p</mi><mo separator="true">,</mo><mi>q</mi><mo stretchy="false">)</mo></mrow></msup><mo>=</mo><msup><mn>2</mn><mrow><mo>âˆ’</mo><mfrac><mn>1</mn><mi>N</mi></mfrac><msub><mo>âˆ‘</mo><mrow><mi>i</mi><mo>=</mo><mn>1</mn></mrow></msub><mi>log</mi><mo>â¡</mo><mi>p</mi><mo stretchy="false">(</mo><msub><mi>x</mi><mi>i</mi></msub><mo stretchy="false">)</mo></mrow></msup></mrow><annotation encoding="application/x-tex">Perplexity=2^{H(p,q)}=2^{-\frac{1}{N}\sum_{i=1}\log p(x_i)}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8889em;vertical-align:-0.1944em;"></span><span class="mord mathnormal" style="margin-right:0.13889em;">P</span><span class="mord mathnormal" style="margin-right:0.02778em;">er</span><span class="mord mathnormal" style="margin-right:0.01968em;">pl</span><span class="mord mathnormal">e</span><span class="mord mathnormal">x</span><span class="mord mathnormal">i</span><span class="mord mathnormal">t</span><span class="mord mathnormal" style="margin-right:0.03588em;">y</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.888em;"></span><span class="mord"><span class="mord">2</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.888em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.08125em;">H</span><span class="mopen mtight">(</span><span class="mord mathnormal mtight">p</span><span class="mpunct mtight">,</span><span class="mord mathnormal mtight" style="margin-right:0.03588em;">q</span><span class="mclose mtight">)</span></span></span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.954em;"></span><span class="mord"><span class="mord">2</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.954em;"><span style="top:-3.363em;margin-right:0.05em;"><span class="pstrut" style="height:3em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">âˆ’</span><span class="mord mtight"><span class="mopen nulldelimiter sizing reset-size3 size6"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.8443em;"><span style="top:-2.656em;"><span class="pstrut" style="height:3em;"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.10903em;">N</span></span></span></span><span style="top:-3.2255em;"><span class="pstrut" style="height:3em;"></span><span class="frac-line mtight" style="border-bottom-width:0.049em;"></span></span><span style="top:-3.384em;"><span class="pstrut" style="height:3em;"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mtight"><span class="mord mtight">1</span></span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.344em;"><span></span></span></span></span></span><span class="mclose nulldelimiter sizing reset-size3 size6"></span></span><span class="mspace mtight" style="margin-right:0.1952em;"></span><span class="mop mtight"><span class="mop op-symbol small-op mtight" style="position:relative;top:0em;">âˆ‘</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.1496em;"><span style="top:-2.1786em;margin-left:0em;margin-right:0.0714em;"><span class="pstrut" style="height:2.5em;"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">i</span><span class="mrel mtight">=</span><span class="mord mtight">1</span></span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.3214em;"><span></span></span></span></span></span></span><span class="mspace mtight" style="margin-right:0.1952em;"></span><span class="mop mtight"><span class="mtight">l</span><span class="mtight">o</span><span class="mtight" style="margin-right:0.01389em;">g</span></span><span class="mspace mtight" style="margin-right:0.1952em;"></span><span class="mord mathnormal mtight">p</span><span class="mopen mtight">(</span><span class="mord mtight"><span class="mord mathnormal mtight">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3281em;"><span style="top:-2.357em;margin-left:0em;margin-right:0.0714em;"><span class="pstrut" style="height:2.5em;"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mathnormal mtight">i</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.143em;"><span></span></span></span></span></span></span><span class="mclose mtight">)</span></span></span></span></span></span></span></span></span></span></span></span></span><span>ï»¿</span></span>.</p><h3 id="1b38841f-85ab-8032-a420-e33b758e54e5" class="">Generation</h3><p id="1b38841f-85ab-80f8-9a86-c99367a0fa2a" class="">é€šè¿‡è®¾ç½® Greedy, topK, Sampling, Temperature ç­‰å‚æ•°ï¼Œæ§åˆ¶è¾“å‡ºã€‚</p><p id="1b38841f-85ab-8094-b7e7-f8e90f03ad60" class="">Beam searchï¼šæ›´åŠ ç¨³å®š</p><figure id="1b38841f-85ab-8015-97ea-e6ed52d096e6" class="image"><a href="image%2025.png"><img style="width:709.9747314453125px" src="image%2025.png"/></a></figure><p id="1b38841f-85ab-80bc-a104-ec8f3c4b6742" class="">Hugging Face æœ‰ä¸€äº›ç°æœ‰çš„è¯„æµ‹ï¼Œä½†æ˜¯ä¸€äº›ç‰¹æ®Šçš„è¯„æµ‹éœ€è¦è‡ªå·±æ„å»º banchmarkã€‚</p><h3 id="1b38841f-85ab-80c1-ac17-d9f2a3c6a50f" class="">æµ‹è¯•é›†</h3><p id="1b38841f-85ab-80eb-a853-fc771a3937cc" class="">ARC Challengeï¼šæ ¹æ®æ ·é¢˜æ¨ç†ã€‚è¿˜æœ‰è®¸å¤šå¸¸ç”¨çš„ç‰¹å®šä»»åŠ¡çš„æµ‹è¯•é›†ï¼Œè¿™é‡Œçœç•¥ã€‚</p><h3 id="1ba8841f-85ab-8084-b53a-f2bd645ccfcf" class="">MTPï¼ˆmulti-token predictionï¼‰</h3><p id="1ba8841f-85ab-80cd-96fb-d9768385d302" class="">Speculative decodingï¼šå°æ¨¡å‹ç”Ÿæˆä¸€äº› token å¹¶ç»™å‡ºç”Ÿæˆçš„æ¦‚ç‡ï¼Œç„¶ååˆ©ç”¨å¤§æ¨¡å‹æ¥ checkï¼Œæˆ–åœ¨ä¸€äº›å…³é”®çš„ä½ç½®åä¿®é¥°ã€‚æ•´ä½“ä¸Šæé«˜æ¨ç†çš„é€Ÿåº¦ï¼Œå¯èƒ½ä¼šä½¿ç”¨åœ¨å…·èº«æ™ºèƒ½ã€‚</p><p id="1ba8841f-85ab-809a-923a-c28c3c57889e" class="">è®¡ç®—å¤§æ¨¡å‹é¢„æµ‹æ¬¡tokençš„æ¦‚ç‡ï¼Œå†³å®šï¼š</p><ul id="1ba8841f-85ab-808b-9b04-cde7b5cae498" class="bulleted-list"><li style="list-style-type:disc"><strong>æ¥å—</strong> éƒ¨åˆ† tokenï¼ˆè·³è¿‡é€ä¸ªè§£ç ï¼‰</li></ul><ul id="1ba8841f-85ab-807b-873f-daa087e4516a" class="bulleted-list"><li style="list-style-type:disc"><strong>æ‹’ç»</strong> ä¸åˆé€‚çš„ tokenï¼ˆå›é€€å¹¶ç»§ç»­æ­£å¸¸è§£ç ï¼‰</li></ul><figure id="1ba8841f-85ab-8096-aed1-d38dc8154f90" class="image"><a href="image%2026.png"><img style="width:480px" src="image%2026.png"/></a></figure><p id="1ba8841f-85ab-8098-b53d-dedf5e7f6bb4" class="">ä¼˜åŠ¿ï¼š</p><ol type="1" id="1ba8841f-85ab-806f-a493-ce663391c8d2" class="numbered-list" start="1"><li>æ¯ä¸ªåºåˆ—äº§ç”Ÿæ›´å¤šçš„ç›‘ç£ä¿¡å·</li></ol><ol type="1" id="1ba8841f-85ab-8077-ac92-f929c044b039" class="numbered-list" start="2"><li>å¯¹é•¿ç¨‹æ–‡æœ¬å…·æœ‰æ›´å¥½çš„ä¸€è‡´æ€§</li></ol><h3 id="1ba8841f-85ab-8083-82b5-e98392de07e0" class="">PDåˆ†ç¦»ï¼ˆPrefill-Decode Disaggregationï¼‰æŠ€æœ¯</h3><p id="1bb8841f-85ab-8045-a6a6-f153e91f6589" class="">è¦æ±‚ï¼šèŠå¤©æœºå™¨äººéœ€è¦å¿«é€Ÿå“åº”ï¼ˆæ¯”å¦‚ä½äº0.2ç§’ï¼‰ï¼Œè€Œè§£ç é€Ÿåº¦å¯ä»¥è¾ƒä¸ºé€‚ä¸­ï¼Œä»…éœ€ä¸äººç±»é˜…è¯»é€Ÿåº¦ç›¸åŒ¹é…ï¼›ä»£ç è¡¥å…¨åˆ™è¦æ±‚å¿«é€Ÿç”Ÿæˆï¼Œä»¥ä¾¿å®æ—¶æä¾›ä»£ç å»ºè®®ã€‚</p><p id="1bb8841f-85ab-8002-a53d-ec4227e4b49c" class="">æœåŠ¡çº§ç›®æ ‡ï¼ˆSLOï¼‰åŒ…æ‹¬ï¼š</p><ul id="1bb8841f-85ab-8019-85bb-f61bfd3da2d0" class="bulleted-list"><li style="list-style-type:disc"><strong>é¦–æ¬¡tokenå»¶è¿Ÿï¼ˆTTFTï¼‰ï¼š</strong>æµ‹é‡LLMç”Ÿæˆç¬¬ä¸€ä¸ªtokençš„æ—¶é—´</li></ul><ul id="1bb8841f-85ab-8028-ad53-f25f327ca2f7" class="bulleted-list"><li style="list-style-type:disc"><strong>æ¯ä¸ªè¾“å‡ºtokençš„æ—¶é—´ï¼ˆTPOTï¼‰ï¼š</strong>æµ‹é‡ä¸¤ä¸ªè¿ç»­ç”Ÿæˆçš„tokenä¹‹é—´çš„å¹³å‡å»¶è¿Ÿ</li></ul><p id="1bb8841f-85ab-8085-a5f0-c0864ed49492" class="">LLMæœåŠ¡ç³»ç»Ÿé€šå¸¸å°†é¢„å¡«å……å’Œè§£ç ä¸€èµ·æ‰¹å¤„ç†ï¼Œä½¿ç”¨è¿­ä»£è°ƒåº¦æˆ–è¿ç»­æ‰¹å¤„ç†æŠ€æœ¯ï¼Œä½¿GPUèƒ½å°½é‡å¤§æ‰¹é‡å¤„ç†ï¼Œä»è€Œæé«˜ååé‡ï¼ˆæ¯ç§’tokenæ•°ï¼‰ï¼ŒvLLMå’ŒTensorRT-LLMç­‰ç³»ç»Ÿéƒ½å¹¿æ³›é‡‡ç”¨è¿™ä¸€æ–¹æ³•ã€‚</p><p id="1bb8841f-85ab-8089-a482-e15fb754645c" class="">é¢„å¡«å……éå¸¸ä¾èµ–è®¡ç®—ï¼Œæ„å‘³ç€å³ä½¿æ˜¯ä¸€ä¸ªå°æ‰¹é‡çš„é¢„å¡«å……ï¼Œæˆ–è€…ä»…ä»…æ˜¯ä¸€ä¸ªè¶³å¤Ÿé•¿çš„é¢„å¡«å……ï¼Œä¹Ÿä¼šè¿…é€Ÿé¥±å’ŒGPUè®¡ç®—èµ„æºã€‚å¦ä¸€æ–¹é¢ï¼Œè§£ç éœ€è¦æ›´å¤§çš„æ‰¹é‡æ¥è¾¾åˆ°è®¡ç®—ç“¶é¢ˆï¼Œä¸”æ›´å®¹æ˜“å—åˆ°GPUå†…å­˜å¸¦å®½é™åˆ¶çš„å½±å“ã€‚</p><p id="1ba8841f-85ab-80a7-afd6-f5ca4822241f" class=""><em><mark class="highlight-blue">é‡åˆ°çš„é—®é¢˜</mark></em>ï¼šé¢„å¡«å……å’Œè§£ç ä¹‹é—´çš„å¹²æ‰°</p><p id="1bb8841f-85ab-806d-a434-e5bc6e0139b0" class="">PD åˆ†ç¦»çš„æ€æƒ³ï¼š<strong>å°†é¢„å¡«å……ï¼ˆPrefillï¼‰å’Œè§£ç ï¼ˆDecodeï¼‰åˆ†é…åˆ°ä¸åŒçš„GPUï¼Œå¹¶ä¸ºæ¯ä¸ªé˜¶æ®µå®šåˆ¶å¹¶è¡Œç­–ç•¥ã€‚</strong></p><p id="1bb8841f-85ab-8097-9dfc-d4cbbbfa3e0c" class="">å…·ä½“æ­¥éª¤ï¼š</p><ol type="1" id="1bb8841f-85ab-80e5-9272-d30371f69681" class="numbered-list" start="1"><li>é¦–å…ˆè¿›å…¥é¢„å¡«å……å·¥ä½œèŠ‚ç‚¹å¹¶å®Œæˆé¢„å¡«å……é˜¶æ®µã€‚</li></ol><ol type="1" id="1bb8841f-85ab-8044-bad6-e7de206c123d" class="numbered-list" start="2"><li>ç„¶åï¼Œç³»ç»Ÿå°†å…¶ä¸­é—´çŠ¶æ€ï¼ˆä¸»è¦æ˜¯KVç¼“å­˜ï¼‰è¿ç§»åˆ°è§£ç å·¥ä½œèŠ‚ç‚¹ï¼Œå¹¶è¿›è¡Œå¤šä¸ªè§£ç æ­¥éª¤ä»¥ç”Ÿæˆåç»­tokenã€‚</li></ol><ol type="1" id="1bb8841f-85ab-803e-93f2-eaeb5075d7c3" class="numbered-list" start="3"><li>è¯·æ±‚åœ¨ç”Ÿæˆå®Œæˆåç¦»å¼€ç³»ç»Ÿ</li></ol><figure id="1ba8841f-85ab-80a9-bfe3-d884e078dc55" class="image"><a href="80433f8b-7b59-4553-afb2-b2a75e07d1be.png"><img style="width:709.984375px" src="80433f8b-7b59-4553-afb2-b2a75e07d1be.png"/></a></figure><p id="1ba8841f-85ab-80c9-b383-d36ddac9191d" class=""><strong>ä»£ä»·</strong>ï¼šéœ€è¦åœ¨é¢„å¡«å……å’Œè§£ç GPUä¹‹é—´ä¼ è¾“ä¸­é—´çŠ¶æ€ï¼ˆå³KVç¼“å­˜ï¼‰</p><h2 id="1ba8841f-85ab-8037-a024-dd317a1ecce5" class="">Data</h2><p id="1ba8841f-85ab-8088-a7f7-f149cc662316" class="">Typical data processing pipline</p><figure id="1ba8841f-85ab-80e2-bd9b-e74829b4339e" class="image"><a href="image%2027.png"><img style="width:2358px" src="image%2027.png"/></a></figure><p id="1ba8841f-85ab-8023-9dd6-dc551e5cd3cb" class="">æ•°æ®æ¸…æ´—æˆæœ¬å¾ˆé«˜ï¼šåœ¨æ¸…æ´—è¿‡ç¨‹ä¸­ï¼Œéœ€è¦å»é™¤é‡å¤ï¼Œå»é™¤markdownï¼ˆæ•ˆæœä¸å¥½ï¼‰ï¼Œå»é™¤è„è¯ï¼ˆä»·å€¼å¯¹é½ï¼‰ç­‰ã€‚</p><h3 id="1ba8841f-85ab-803f-aab2-d9e35897790d" class="">é€€ç«æ•°æ®</h3><p id="1ba8841f-85ab-8094-a1d1-c5420d513e55" class="">åœ¨é¢„è®­ç»ƒçš„æœ€åé˜¶æ®µï¼Œåˆ·å°æ•°æ®é‡çš„é«˜è´¨é‡è€ƒé¢˜ã€‚ä½¿ç”¨é€€ç«æ–¹æ³•æ£€æµ‹æ•°æ®è´¨é‡å¯¹è®­ç»ƒæ•ˆæœçš„å½±å“ï¼Œ30%æ–°æ•°æ®ï¼Œ70%æ—§æ•°æ®ï¼Œæ£€æµ‹æ–°æ•°æ®é›†çš„æ•ˆæœã€‚</p><h2 id="1ba8841f-85ab-801c-89a5-d4afcb26aad2" class="">Recall Scaling Law</h2><p id="1ba8841f-85ab-80d0-9c5d-cbb352347f5b" class="">Many questions you can try to answer with scaling laws</p><div id="1ba8841f-85ab-80ce-8dec-edaea6a46c58" class="column-list"><div id="1ba8841f-85ab-8026-8e82-f6f75c07191c" style="width:100%" class="column"><p id="1ba8841f-85ab-807a-8d4f-e815dfaeb5a8" class="">Resource allocation:<br/>â€¢ Train models longer vs train bigger models?<br/>â€¢ Collect more data vs get more GPUs?<br/></p></div><div id="1ba8841f-85ab-80ea-b648-f2a3c87e8d93" style="width:100%" class="column"><p id="1ba8841f-85ab-8048-87d6-f652b596a71b" class="">Data:<br/>â€¢ Data repetition / multiple epochs?<br/>â€¢ Data mixture weighting?<br/></p></div><div id="1ba8841f-85ab-8093-91e7-c39dcd5eb442" style="width:100%" class="column"><p id="1ba8841f-85ab-8091-9eb2-ed5a9998cde2" class="">Algorithm:<br/>â€¢ Arch: LSTMs vs transformers?<br/>â€¢ Size: width vs depth?<br/></p></div></div><h3 id="1ba8841f-85ab-80bc-aaec-c39c8a0e1a85" class="">Bremermann Limit</h3><p id="1ba8841f-85ab-8027-a062-c02a3dd140c7" class=""><style>@import url('https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.16.9/katex.min.css')</style><span data-token-index="0" contenteditable="false" class="notion-text-equation-token" style="user-select:all;-webkit-user-select:all;-moz-user-select:all"><span></span><span><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mtext>æœ€å¤§è®¡ç®—æ·±åº¦</mtext><mo>=</mo><mstyle displaystyle="true" scriptlevel="0"><mfrac><mrow><mn>2</mn><mo>Ã—</mo><mtext>è´¨é‡</mtext><mo>Ã—</mo><msup><mi>c</mi><mn>2</mn></msup></mrow><mi>h</mi></mfrac></mstyle></mrow><annotation encoding="application/x-tex">æœ€å¤§è®¡ç®—æ·±åº¦=\dfrac{2\times è´¨é‡\times c^2}{h}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord cjk_fallback">æœ€å¤§è®¡ç®—æ·±åº¦</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:2.1771em;vertical-align:-0.686em;"></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.4911em;"><span style="top:-2.314em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord mathnormal">h</span></span></span><span style="top:-3.23em;"><span class="pstrut" style="height:3em;"></span><span class="frac-line" style="border-bottom-width:0.04em;"></span></span><span style="top:-3.677em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord">2</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">Ã—</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mord cjk_fallback">è´¨é‡</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">Ã—</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mord"><span class="mord mathnormal">c</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8141em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span></span></span></span></span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.686em;"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span></span></span></span></span><span>ï»¿</span></span>ï¼Œc  ä¸ºå…‰é€Ÿï¼Œh ä¸ºæ™®æœ—å…‹å¸¸é‡ã€‚æ‰€ä»¥ç®—åŠ›æ˜¯æœ‰ä¸Šç•Œçš„ï¼ŒScaling Law ä¸èƒ½æŒç»­å»¶ä¼¸ä¸‹å»ã€‚</p><h3 id="1ba8841f-85ab-8001-9f0b-e7d4c8f0143b" class="">Surprising Costs</h3><figure id="1ba8841f-85ab-80a0-bd60-d5985b5ad611" class="image"><a href="image%2028.png"><img style="width:709.9857177734375px" src="image%2028.png"/></a></figure><h2 id="1ba8841f-85ab-8073-bfbb-d4a8ba369e01" class="">System</h2><ol type="1" id="1ba8841f-85ab-8095-81c2-f6514ce71acc" class="numbered-list" start="1"><li>å­˜å‚¨å™¨å±±ï¼ˆç•¥ï¼‰</li></ol><ol type="1" id="1ba8841f-85ab-80b8-9e0e-ca4c18fda7c2" class="numbered-list" start="2"><li>è®¾å¤‡çš„é€Ÿåº¦ï¼šComputer &gt; memory &amp; communication</li></ol><ol type="1" id="1ba8841f-85ab-8095-9254-cb0979ef2a18" class="numbered-list" start="3"><li><strong>Model FLOP Utilizationï¼ˆMFUï¼‰</strong> æ˜¯ <strong>è¡¡é‡å¤§æ¨¡å‹åœ¨ GPU ä¸Šè®¡ç®—æ•ˆç‡</strong> çš„ä¸€ä¸ªæŒ‡æ ‡ï¼Œè¡¨ç¤º <strong>å®é™…è®¡ç®—ååé‡ï¼ˆobserved throughputï¼‰ä¸è¯¥ GPU ç†è®ºè®¡ç®—èƒ½åŠ›ï¼ˆtheoretical bestï¼‰çš„æ¯”å€¼ã€‚</strong>TheoreticalÂ FLOPs=CUDAÂ CoreÂ æ•°Ã—æ—¶é’Ÿé¢‘ç‡Ã—æ¯ä¸ªæ—¶é’Ÿå‘¨æœŸçš„è¿ç®—æ¬¡æ•°ã€‚å¾€å¾€æ— æ³•è¾¾åˆ°ç†è®ºçš„æœ€å¤§è®¡ç®—é‡ï¼Œ50% å°±å·²ç»æ˜¯å¾ˆå¥½äº†ï¼Œè¦è€ƒè™‘ä¼ è¾“å’Œå¸¦å®½ã€‚</li></ol><h3 id="1ba8841f-85ab-80c2-bfef-dee26d96a18e" class="">NVIDIA DGX H100, 2022</h3><p id="1ba8841f-85ab-804d-9e64-fb0ed607d170" class="">ä¸€å¼ H100</p><figure id="1ba8841f-85ab-80ce-9ad5-ff77ec24f405" class="image"><a href="image%2029.png"><img style="width:709.9793701171875px" src="image%2029.png"/></a></figure><p id="1ba8841f-85ab-8021-97bd-c2905c1ad8f5" class="">ç´«è‰²éƒ¨åˆ†ï¼šå¡é—´äº’è”ï¼ˆå…‰çº¤ï¼‰ï¼›é»„çº¿éƒ¨åˆ†ï¼šI/O</p><p id="1ba8841f-85ab-8044-9c59-f4a16ca5e994" class="">æ¯å°æœåŠ¡å™¨æœ‰8ä¸ª GPU</p><figure id="1ba8841f-85ab-80c9-a690-e76416bcb710" class="image"><a href="image%2030.png"><img style="width:709.9793701171875px" src="image%2030.png"/></a></figure><div id="1ba8841f-85ab-80ce-8620-caeb2a906c47" class="column-list"><div id="1ba8841f-85ab-8097-933e-e544276c4fd5" style="width:50%" class="column"><figure id="1ba8841f-85ab-80cb-bd1c-d7745356e736" class="image"><a href="image%2031.png"><img style="width:709.9819946289062px" src="image%2031.png"/></a></figure></div><div id="1ba8841f-85ab-800c-83b6-f96f3d49a625" style="width:50%" class="column"><p id="1ba8841f-85ab-8059-b10a-c1f100cf99c7" class="">æ¯ä¸ª SU æœ‰ 256 ä¸ª H100</p><figure id="1ba8841f-85ab-8007-9922-e31278a00cf7" class="image"><a href="image%2032.png"><img style="width:369.3954772949219px" src="image%2032.png"/></a></figure><p id="1ba8841f-85ab-800d-954b-f5f04411a10f" class="">8 ä¸ªå¶å…±äº« 16 ä¸ªspine</p></div></div><h3 id="1ba8841f-85ab-802e-84b5-c5bea08805e5" class=""> Infiniband vs Ethernet</h3><table id="1ba8841f-85ab-8061-9b95-f6727073eab8" class="simple-table"><tbody><tr id="1ba8841f-85ab-8083-8259-cc05d9c886f4"><td id="&gt;`VX" class=""><strong>å¯¹æ¯”é¡¹</strong></td><td id="?ILh" class="" style="width:343.2192687988281px"><strong>InfiniBand (IB)</strong></td><td id="wA`R" class="" style="width:239.0460205078125px"><strong>Ethernet (ä»¥å¤ªç½‘)</strong></td></tr><tr id="1ba8841f-85ab-8016-829a-c07ed71f7069"><td id="&gt;`VX" class=""><strong>ä¸»è¦ç”¨é€”</strong></td><td id="?ILh" class="" style="width:343.2192687988281px">HPCï¼ˆé«˜æ€§èƒ½è®¡ç®—ï¼‰ï¼ŒAI è®­ç»ƒï¼ˆLLMï¼‰</td><td id="wA`R" class="" style="width:239.0460205078125px">ä¼ä¸šç½‘ç»œï¼Œæ•°æ®ä¸­å¿ƒ</td></tr><tr id="1ba8841f-85ab-80c1-8f73-f72f943fe66c"><td id="&gt;`VX" class=""><strong>å¸¦å®½</strong></td><td id="?ILh" class="" style="width:343.2192687988281px">æœ€é«˜ <strong>1600 Gbpsï¼ˆNVIDIA Quantum-2ï¼‰</strong></td><td id="wA`R" class="" style="width:239.0460205078125px">å…¸å‹ <strong>1G/10G/100G</strong>ï¼Œæœ€æ–° 400G</td></tr><tr id="1ba8841f-85ab-8022-b471-ddfaf79a971a"><td id="&gt;`VX" class=""><strong>å»¶è¿Ÿ</strong></td><td id="?ILh" class="" style="width:343.2192687988281px">ä½è‡³ <strong>1-2 å¾®ç§’ï¼ˆÎ¼sï¼‰</strong></td><td id="wA`R" class="" style="width:239.0460205078125px"><strong>ä¸€èˆ¬ 5-50 å¾®ç§’ï¼ˆÎ¼sï¼‰</strong></td></tr><tr id="1ba8841f-85ab-80a8-ab86-e6a6906f832d"><td id="&gt;`VX" class=""><strong>æ‹“æ‰‘ç»“æ„</strong></td><td id="?ILh" class="" style="width:343.2192687988281px"><strong>RDMA ç›´è¿ï¼ˆæ—  CPU ä»‹å…¥ï¼‰</strong></td><td id="wA`R" class="" style="width:239.0460205078125px"><strong>æ ‡å‡† TCP/IP åè®®</strong></td></tr><tr id="1ba8841f-85ab-80c0-bd5c-d4bcaf45735e"><td id="&gt;`VX" class=""><strong>åè®®</strong></td><td id="?ILh" class="" style="width:343.2192687988281px"><strong>Remote Direct Memory Access (RDMA)</strong>ï¼Œæ”¯æŒ RoCE</td><td id="wA`R" class="" style="width:239.0460205078125px"><strong>TCP/IP</strong>ï¼Œéƒ¨åˆ†æ”¯æŒ RoCE</td></tr><tr id="1ba8841f-85ab-80aa-831a-c67097ecab4a"><td id="&gt;`VX" class=""><strong>è®¡ç®—ä»»åŠ¡</strong></td><td id="?ILh" class="" style="width:343.2192687988281px"><strong>æ·±åº¦å­¦ä¹ è®­ç»ƒã€å¤§è§„æ¨¡ AIã€HPC è¶…ç®—</strong></td><td id="wA`R" class="" style="width:239.0460205078125px"><strong>äº‘è®¡ç®—ã€æ•°æ®åº“ã€å­˜å‚¨</strong></td></tr><tr id="1ba8841f-85ab-8086-b26b-c08568b49b3c"><td id="&gt;`VX" class=""><strong>æˆæœ¬</strong></td><td id="?ILh" class="" style="width:343.2192687988281px"><strong>é«˜ï¼ˆä¸“æœ‰è®¾å¤‡ï¼Œäº¤æ¢æœºæ˜‚è´µï¼‰</strong></td><td id="wA`R" class="" style="width:239.0460205078125px"><strong>ä½ï¼ˆé€šç”¨è®¾å¤‡ï¼Œå¯æ‰©å±•æ€§å¼ºï¼‰</strong></td></tr></tbody></table><h3 id="1ba8841f-85ab-8000-9c96-fc675af8715f" class="">Parallelism</h3><p id="1ba8841f-85ab-8056-a2a9-ef770b82293b" class=""><strong>æ•°æ®å¹¶è¡Œ</strong>ä¸<strong>å¼ é‡å¹¶è¡Œ</strong>ï¼š</p><table id="1ba8841f-85ab-8060-9747-dfabaea358ef" class="simple-table"><tbody><tr id="1ba8841f-85ab-8028-97b6-c1a1df7cf861"><td id="lldT" class=""><strong>å¹¶è¡Œæ–¹å¼</strong></td><td id="@ify" class=""><strong>æ ¸å¿ƒæ€æƒ³</strong></td><td id="xeXH" class=""><strong>è®¡ç®—æ‹†åˆ†æ–¹å¼</strong></td><td id="wPQN" class=""><strong>é€šä¿¡å¼€é”€</strong></td><td id="fymc" class=""><strong>é€‚ç”¨åœºæ™¯</strong></td></tr><tr id="1ba8841f-85ab-8087-b386-f1f181a20404"><td id="lldT" class=""><strong>æ•°æ®å¹¶è¡Œï¼ˆDPï¼‰</strong></td><td id="@ify" class=""><strong>å¤åˆ¶æ¨¡å‹ï¼Œåˆ’åˆ†æ•°æ®</strong></td><td id="xeXH" class=""><strong>æ¯ä¸ª GPU è®¡ç®—ä¸åŒçš„æ•°æ® batch</strong>ï¼Œä½†æ¨¡å‹ç›¸åŒ</td><td id="wPQN" class=""><strong>ä½ï¼ˆä»…åŒæ­¥æ¢¯åº¦ï¼‰</strong></td><td id="fymc" class=""><strong>å°åˆ°ä¸­ç­‰è§„æ¨¡æ¨¡å‹ï¼Œè®­ç»ƒåŠ é€Ÿ</strong></td></tr><tr id="1ba8841f-85ab-801b-b1d4-d460877ae63f"><td id="lldT" class=""><strong>å¼ é‡å¹¶è¡Œï¼ˆTPï¼‰</strong></td><td id="@ify" class=""><strong>æ‹†åˆ†å•ä¸ªæ¨¡å‹å±‚çš„è®¡ç®—</strong></td><td id="xeXH" class=""><strong>ä¸€ä¸ªæ¨¡å‹çš„æŸå±‚å‚æ•°æ‹†åˆ†åˆ°å¤šä¸ª GPU</strong></td><td id="wPQN" class=""><strong>é«˜ï¼ˆè®¡ç®—è¿‡ç¨‹ä¸­éœ€è¦ GPU äº¤äº’ï¼‰</strong></td><td id="fymc" class=""><strong>è¶…å¤§æ¨¡å‹ï¼ˆGPT-4ã€DeepSeekï¼‰æ¨ç†åŠ é€Ÿ</strong></td></tr></tbody></table><p id="1ba8841f-85ab-8078-83e3-e25cd5f10f26" class="">å¹¶è¡Œæ–¹å¼ï¼š</p><ol type="1" id="1ba8841f-85ab-808b-bdfc-d609808220ac" class="numbered-list" start="1"><li>ä¼˜åŒ–å™¨åˆ†ç‰‡</li></ol><ol type="1" id="1ba8841f-85ab-80fa-aec5-cc459ae67e47" class="numbered-list" start="2"><li>æ¢¯åº¦åˆ†ç‰‡</li></ol><ol type="1" id="1ba8841f-85ab-8055-a0e8-d8ab5416bb1d" class="numbered-list" start="3"><li>å‚æ•°åˆ†ç‰‡</li></ol><p id="1ba8841f-85ab-80c8-a708-f46b1c3c42aa" class=""> data parallelism only works if batch size &gt;=  GPUS_num</p><p id="1ba8841f-85ab-8006-a801-c108c03fcb45" class="">å¼ é‡å¹¶è¡Œæ˜¯æ¨¡å‹å‚æ•°é‡éå¸¸å¤§çš„æ—¶å€™å¿…é¡»è¦åšçš„ã€‚</p><p id="1ba8841f-85ab-801a-838f-dabb22094ef5" class="">é‡åˆ°çš„é—®é¢˜ï¼šå¦‚æœæ¥å…¥æµæ°´çº¿ï¼Œä¼šéœ€è¦æ’å…¥ Bubbleï¼Œä¼šæœ‰æ—¶é—´æŸè€—ã€‚</p><figure id="1ba8841f-85ab-808f-97ae-f3b6cb096c8d" class="image"><a href="image%2033.png"><img style="width:720px" src="image%2033.png"/></a></figure><p id="1ba8841f-85ab-804f-8d6a-f3c64eba55e1" class="">è§£å†³æ–¹æ¡ˆï¼šæµæ°´çº¿å¹¶è¡Œä¸­æŠŠ Batch å˜å°</p><figure id="1ba8841f-85ab-80aa-8c09-c2573db30430" class="image"><a href="305aacc7-645a-4744-bdce-16d0eca2823d.png"><img style="width:720px" src="305aacc7-645a-4744-bdce-16d0eca2823d.png"/></a></figure><p id="1ba8841f-85ab-8070-8cfe-ca5586858f4d" class=""><style>@import url('https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.16.9/katex.min.css')</style><span data-token-index="0" contenteditable="false" class="notion-text-equation-token" style="user-select:all;-webkit-user-select:all;-moz-user-select:all"><span></span><span><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>A</mi><mi>i</mi></msub></mrow><annotation encoding="application/x-tex">A_i</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8333em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal">A</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3117em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">i</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span></span><span>ï»¿</span></span> æ˜¯ä¸€ä¸ªbatch A çš„åˆ‡åˆ†ï¼Œ æ¯ä¸ªdeviceåˆ†å¸ƒç€æ¨¡å‹çš„ä¸€äº›å‚æ•°ã€‚è¿›ä¸€æ­¥åŠ é€Ÿï¼šï¼ˆå‡å°‘æ’å…¥çš„ Bubbleï¼‰</p><figure id="1ba8841f-85ab-8088-93bc-db89a2a01511" class="image"><a href="image%2034.png"><img style="width:709.9819946289062px" src="image%2034.png"/></a></figure><p id="1ba8841f-85ab-809e-8c48-e8486aba71e2" class="">
</p></div></article><span class="sans" style="font-size:14px;padding-top:2em"></span></body></html>